<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c3{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Arial";font-style:normal}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:6pt;font-family:"Arial";font-style:normal}.c97{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:6pt;font-family:"Arial";font-style:normal}.c44{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Arial";font-style:normal}.c156{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:5.4pt;font-family:"Arial";font-style:normal}.c52{color:#ff0000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:8pt;font-family:"Arial";font-style:normal}.c90{color:#262626;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:6.4pt;font-family:"Arial";font-style:normal}.c92{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:8pt;font-family:"Arial";font-style:normal}.c14{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Courier New";font-style:normal}.c146{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:13.3pt;font-family:"Courier New";font-style:normal}.c118{color:#262626;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:3.4pt;font-family:"Arial";font-style:normal}.c115{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:7.7pt;font-family:"Arial";font-style:normal}.c69{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:13.3pt;font-family:"Courier New";font-style:normal}.c61{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:9.1pt;font-family:"Arial";font-style:normal}.c88{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Times New Roman";font-style:normal}.c18{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:7.3pt;font-family:"Arial";font-style:normal}.c106{margin-left:-17.1pt;padding-top:2.2pt;text-indent:27.4pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-18pt}.c20{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:13.3pt;font-family:"Arial";font-style:normal}.c141{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:10pt;font-family:"Arial";font-style:normal}.c161{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:5.9pt;font-family:"Arial";font-style:normal}.c128{color:#262626;font-weight:700;text-decoration:none;vertical-align:sub;font-size:12.6pt;font-family:"Arial";font-style:normal}.c66{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:14.9pt;font-family:"Courier New";font-style:normal}.c60{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:10.3pt;font-family:"Courier New";font-style:normal}.c9{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:12.1pt;font-family:"Arial";font-style:normal}.c132{margin-left:-16.9pt;padding-top:4.8pt;text-indent:27pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-18.2pt}.c10{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:7.7pt;font-family:"Arial";font-style:normal}.c57{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:6.4pt;font-family:"Arial";font-style:italic}.c133{margin-left:-18.7pt;padding-top:15.6pt;text-indent:19pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-17.6pt}.c21{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:6.8pt;font-family:"Courier New";font-style:normal}.c38{color:#262626;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:4.7pt;font-family:"Arial";font-style:normal}.c84{color:#ff0000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:14.9pt;font-family:"Arial";font-style:normal}.c103{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Courier New";font-style:normal}.c33{color:#262626;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:4.5pt;font-family:"Arial";font-style:normal}.c4{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:8pt;font-family:"Arial";font-style:normal}.c30{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:14.9pt;font-family:"Arial";font-style:normal}.c23{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:10.3pt;font-family:"Arial";font-style:normal}.c13{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:10.3pt;font-family:"Arial";font-style:normal}.c111{color:#000000;font-weight:700;text-decoration:none;vertical-align:super;font-size:9.7pt;font-family:"Arial";font-style:normal}.c127{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:4.6pt;font-family:"Arial";font-style:normal}.c77{margin-left:-16.9pt;padding-top:1.9pt;text-indent:27pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-19.4pt}.c93{color:#262626;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:4.4pt;font-family:"Arial";font-style:normal}.c63{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:6.3pt;font-family:"Arial";font-style:italic}.c32{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10.9pt;font-family:"Arial";font-style:normal}.c164{margin-left:-19pt;padding-top:2.2pt;text-indent:28.8pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-17.4pt}.c158{margin-left:-19pt;padding-top:15.8pt;text-indent:19.2pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-17.6pt}.c116{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:9.9pt;font-family:"Arial";font-style:normal}.c101{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:11.4pt;font-family:"Arial";font-style:normal}.c147{margin-left:-18.7pt;padding-top:2.2pt;text-indent:28.6pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-17.6pt}.c120{margin-left:-12.3pt;padding-top:14.9pt;text-indent:12.6pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-15.1pt}.c100{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:7.3pt;font-family:"Arial";font-style:normal}.c102{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:5.8pt;font-family:"Arial";font-style:italic}.c119{color:#262626;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:4.9pt;font-family:"Arial";font-style:normal}.c31{margin-left:-17.1pt;padding-top:1.9pt;text-indent:27.4pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-19.4pt}.c123{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:5pt;font-family:"Arial";font-style:normal}.c11{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:8.3pt;font-family:"Arial";font-style:normal}.c35{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:7.3pt;font-family:"Courier New";font-style:normal}.c165{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:8.1pt;font-family:"Arial";font-style:normal}.c54{color:#000000;font-weight:700;text-decoration:none;vertical-align:super;font-size:11.6pt;font-family:"Arial";font-style:normal}.c79{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:6.9pt;font-family:"Arial";font-style:normal}.c58{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:8.4pt;font-family:"Arial";font-style:normal}.c67{margin-left:-19pt;padding-top:16.3pt;text-indent:19.4pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-17.8pt}.c24{color:#262626;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:4pt;font-family:"Arial";font-style:normal}.c27{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:7.4pt;font-family:"Arial";font-style:normal}.c47{margin-left:-16.9pt;padding-top:1.2pt;text-indent:32.5pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-19.2pt}.c26{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:11.9pt;font-family:"Courier New";font-style:normal}.c83{color:#ff0000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:13.3pt;font-family:"Arial";font-style:normal}.c86{color:#ff0000;font-weight:400;text-decoration:none;vertical-align:super;font-size:12.1pt;font-family:"Arial";font-style:normal}.c95{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:9.1pt;font-family:"Arial";font-style:normal}.c163{margin-left:-17.4pt;padding-top:6.5pt;text-indent:60.8pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-19.4pt}.c70{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:5.7pt;font-family:"Arial";font-style:italic}.c76{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:12.6pt;font-family:"Arial";font-style:normal}.c55{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:10.5pt;font-family:"Arial";font-style:normal}.c65{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:6.2pt;font-family:"Arial";font-style:normal}.c48{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:12.1pt;font-family:"Courier New";font-style:normal}.c7{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:14.9pt;font-family:"Arial";font-style:normal}.c46{color:#262626;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:4.8pt;font-family:"Arial";font-style:normal}.c72{color:#262626;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:7.6pt;font-family:"Arial";font-style:normal}.c152{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:6.7pt;font-family:"Arial";font-style:normal}.c121{color:#000000;font-weight:700;text-decoration:none;vertical-align:super;font-size:7.9pt;font-family:"Arial";font-style:normal}.c15{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:11pt;font-family:"Arial";font-style:normal}.c134{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:6pt;font-family:"Arial";font-style:normal}.c136{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:7.4pt;font-family:"Arial";font-style:normal}.c34{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:10.6pt;font-family:"Arial";font-style:normal}.c17{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:6.8pt;font-family:"Arial";font-style:normal}.c12{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:11.6pt;font-family:"Arial";font-style:normal}.c142{color:#262626;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:5pt;font-family:"Arial";font-style:normal}.c145{margin-left:-19pt;padding-top:1.9pt;text-indent:29.3pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-17.6pt}.c68{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:11pt;font-family:"Arial";font-style:normal}.c71{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:7.1pt;font-family:"Courier New";font-style:normal}.c110{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:5.9pt;font-family:"Arial";font-style:normal}.c56{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Arial";font-style:normal}.c5{color:#ff0000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Arial";font-style:normal}.c59{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:17.2pt;font-family:"Arial";font-style:normal}.c78{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:7.5pt;font-family:"Arial";font-style:normal}.c87{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:6.6pt;font-family:"Arial";font-style:normal}.c73{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:14.6pt;font-family:"Arial";font-style:normal}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:12.1pt;font-family:"Arial";font-style:normal}.c124{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:7.5pt;font-family:"Arial";font-style:normal}.c19{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:7pt;font-family:"Arial";font-style:normal}.c22{color:#0000ff;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Arial";font-style:normal}.c51{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:6.6pt;font-family:"Arial";font-style:normal}.c113{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:10.1pt;font-family:"Arial";font-style:normal}.c143{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:6.6pt;font-family:"Arial";font-style:italic}.c16{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:8pt;font-family:"Courier New";font-style:normal}.c105{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:10.3pt;font-family:"Courier New";font-style:normal}.c0{color:#262626;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:6.3pt;font-family:"Arial";font-style:normal}.c28{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:7.9pt;font-family:"Arial";font-style:normal}.c104{color:#262626;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:4.6pt;font-family:"Arial";font-style:normal}.c8{margin-left:-16.9pt;padding-top:2.2pt;text-indent:27pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-19.4pt}.c40{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:13.8pt;font-family:"Arial";font-style:normal}.c114{color:#262626;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:5.9pt;font-family:"Arial";font-style:normal}.c53{color:#262626;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:6pt;font-family:"Arial";font-style:normal}.c154{color:#262626;font-weight:700;text-decoration:none;vertical-align:super;font-size:5.8pt;font-family:"Arial";font-style:normal}.c94{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:9.6pt;font-family:"Arial";font-style:italic}.c117{color:#0000ff;font-weight:400;text-decoration:none;vertical-align:sub;font-size:14.9pt;font-family:"Arial";font-style:normal}.c39{margin-left:-16.9pt;padding-top:6.5pt;text-indent:27pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-18.7pt}.c98{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:10pt;font-family:"Arial";font-style:normal}.c81{margin-left:-18.5pt;padding-top:12.2pt;text-indent:28.3pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-16.4pt}.c43{color:#000000;font-weight:700;text-decoration:none;vertical-align:super;font-size:12.6pt;font-family:"Arial";font-style:normal}.c37{color:#000000;font-weight:400;text-decoration:none;vertical-align:sub;font-size:13.3pt;font-family:"Arial";font-style:normal}.c36{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:5.5pt;font-family:"Arial";font-style:normal}.c74{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:8.3pt;font-family:"Arial";font-style:normal}.c41{margin-left:-18.5pt;padding-top:20.2pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:141.8pt}.c64{margin-left:-16.9pt;padding-top:8.9pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:132pt}.c155{margin-left:-16.9pt;padding-top:1pt;padding-bottom:0pt;line-height:1.15;text-align:center;margin-right:-17.8pt}.c62{margin-left:218.6pt;padding-top:69.4pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-35.4pt}.c82{margin-left:-16.9pt;padding-top:1pt;padding-bottom:0pt;line-height:1.15;text-align:center;margin-right:-19.2pt}.c135{margin-left:-2.6pt;padding-top:1.9pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-15.9pt}.c150{margin-left:-19pt;padding-top:11.5pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-17.4pt}.c108{margin-left:218.6pt;padding-top:190.6pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-35.4pt}.c89{margin-left:-16.9pt;padding-top:10.6pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-18.7pt}.c130{margin-left:218.6pt;padding-top:50.2pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-35.4pt}.c139{margin-left:-2.6pt;padding-top:2.2pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-17.6pt}.c167{margin-left:-2.6pt;padding-top:1.9pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:63pt}.c166{margin-left:18.2pt;padding-top:30.2pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:159.3pt}.c162{margin-left:-18.5pt;padding-top:15.8pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:146.3pt}.c99{margin-left:143.8pt;padding-top:8.9pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:144.7pt}.c151{margin-left:18.2pt;padding-top:13.4pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:159pt}.c153{margin-left:-2.6pt;padding-top:2.2pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-17.8pt}.c85{margin-left:-2.6pt;padding-top:1.9pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-17.6pt}.c49{margin-left:-16.9pt;padding-top:15.4pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:30.2pt}.c169{margin-left:-2.6pt;padding-top:2.2pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-16.2pt}.c157{margin-left:18.5pt;padding-top:14.9pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:21.4pt}.c138{margin-left:-2.6pt;padding-top:2.2pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-16.2pt}.c112{margin-left:-19pt;padding-top:13pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-17.8pt}.c148{margin-left:-18.5pt;padding-top:10.3pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-16.2pt}.c126{margin-left:-8.6pt;padding-top:1.9pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:40.5pt}.c160{margin-left:-15.4pt;padding-top:3.8pt;padding-bottom:0pt;line-height:1.15;text-align:left;margin-right:-17.4pt}.c149{margin-left:-17.1pt;padding-top:13.9pt;padding-bottom:0pt;line-height:1.15;text-align:justify;margin-right:-19.2pt}.c137{padding-top:2.2pt;text-indent:27pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c107{padding-top:0.7pt;text-indent:27pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c42{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:center}.c6{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:justify}.c25{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c109{padding-top:1pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c50{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:right}.c129{margin-left:-16.9pt;text-indent:32.5pt;margin-right:-19pt}.c140{margin-left:-18.5pt;text-indent:33.8pt;margin-right:-17.4pt}.c131{margin-left:-16.9pt;text-indent:32.5pt;margin-right:-19.2pt}.c125{margin-left:-16.9pt;text-indent:32.5pt;margin-right:-17.8pt}.c80{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c144{margin-left:-16.9pt;margin-right:-19.4pt}.c159{margin-left:-18.5pt;margin-right:-17.1pt}.c91{margin-left:36.6pt;margin-right:35.8pt}.c75{margin-left:-185.4pt;margin-right:53pt}.c122{margin-left:-1.3pt;margin-right:-10.8pt}.c96{margin-left:-17.1pt;margin-right:-19.4pt}.c29{margin-left:-16.9pt;margin-right:-18pt}.c45{margin-left:-185.4pt;margin-right:56.9pt}.c168{text-indent:32.5pt}.title{padding-top:24pt;color:#000000;font-weight:700;font-size:36pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:18pt;color:#666666;font-size:24pt;padding-bottom:4pt;font-family:"Georgia";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:24pt;color:#000000;font-weight:700;font-size:24pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-weight:700;font-size:18pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:14pt;color:#000000;font-weight:700;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:12pt;color:#000000;font-weight:700;font-size:12pt;padding-bottom:2pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:11pt;color:#000000;font-weight:700;font-size:11pt;padding-bottom:2pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:10pt;color:#000000;font-weight:700;font-size:10pt;padding-bottom:2pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}</style></head><body class="c80"><p class="c25"><span class="c88">Series ISSN: 2367-2005 277 </span><span class="c103">10.5441/002/edbt.2018.25 </span></p><p class="c25"><span class="c59">Privacy Preserving Group Nearest Neighbor Search </span></p><p class="c42"><span class="c56">Yuncheng Wu</span><span class="c73">&lowast; </span><span class="c44">Renmin University of China Beijing, China yunchengwu@ruc.edu.cn </span></p><p class="c42"><span class="c56">Ke Wang </span><span class="c44">Simon Fraser University Burnaby, Canada wangk@cs.sfu.ca </span></p><p class="c42"><span class="c56">Zhilin Zhang </span><span class="c44">Simon Fraser University Burnaby, Canada zhilinz@sfu.ca </span></p><p class="c42"><span class="c56">Weipeng Lin </span><span class="c44">Simon Fraser University Burnaby, Canada weipengl@sfu.ca </span></p><p class="c42"><span class="c56">Hong Chen</span><span class="c73">&dagger; </span><span class="c44">Renmin University of China Beijing, China chong@ruc.edu.cn </span></p><p class="c42"><span class="c56">Cuiping Li </span><span class="c44">Renmin University of China Beijing, China cuipingli@ruc.edu.cn </span></p><p class="c25"><span class="c32">ABSTRACT </span><span class="c3">Groupk-nearest neighbor (kGNN) search allows a group of n mo- bile users to jointly retrievek points from a location-based service provider (LSP) that minimizes the aggregate distance to them. We identify four protection objectives in the privacy preserv- ing kGNN search: (i) every user&rsquo;s location should be protected from LSP; (ii) the group&rsquo;s query and the query answer should be protected from LSP; (iii) LSP&rsquo;s private database information should be protected from users, i.e., the users cannot learn more information beyond the answer they requested; (iv) every user&rsquo;s location should be protected from the other users in the group. </span></p><p class="c6"><span class="c3">We propose the first approach to meet the four privacy goals in the kGNN query. Our approach provides an accurate query answer and does not rely on heavy pre-computation on LSP like previous works. Our approach considers the most hostile envi- ronment that any n &minus; 1 users in the query group may collude to infer the location of the remaining user. Though we consider kGNN, the proposed privacy preserving approach can be easily adopted to any group query because it treats the query answering (i.e., kGNN) as a black box. Theoretical and experimental analysis suggest that our approach is highly efficient in both user com- putation and communication while incurring some reasonable overhead on LSP. </span></p><p class="c25"><span class="c32">1 INTRODUCTION </span><span class="c3">The embedding of positioning capabilities (e.g., GPS) in mobile devices facilitates the emergence of location-based services (LBS), which allows the users to publish their location data for retrieving desired information from a database maintained by a location- based service provider (LSP). One typical application is the group k-nearest neighbor query (kGNN) proposed in [</span><span class="c22">24</span><span class="c3">], also known as aggregate nearest neighbor query [</span><span class="c22">25</span><span class="c3">] or aggregate similarity search [</span><span class="c22">18</span><span class="c3">, </span><span class="c22">19</span><span class="c3">, </span><span class="c22">28</span><span class="c3">]. The kGNN query allows a group of n users to retrieve top-k locations from the LSP&rsquo;s database to minimize some aggregate cost function F over all n users. Figure </span><span class="c5">1 </span><span class="c3">shows that users u</span><span class="c18">1</span><span class="c3">,u</span><span class="c18">2</span><span class="c3">,u</span><span class="c18">3 </span><span class="c3">(n = 3) jointly retrieve the top-2 meeting places {p</span><span class="c1">1</span><span class="c7">,p</span><span class="c1">2</span><span class="c7">} (k = 2), where p</span><span class="c1">1 </span><span class="c7">has the shortest total distance </span><span class="c3">to the users, and p</span><span class="c1">2 </span><span class="c7">has the second shortest total distance to the </span><span class="c3">users. By generalizing the classick-nearest neighbor (kNN) query from a single user in a query to multiple users in a query, the </span></p><p class="c25"><span class="c36">&lowast;</span><span class="c12">This work was done when this author visited Simon Fraser University. </span><span class="c36">&dagger;</span><span class="c12">Corresponding author. </span></p><p class="c25"><span class="c19">&copy; 2018 Copyright held by the owner/author(s). Published in Proceedings of the 21st International Conference on Extending Database Technology (EDBT), March 26-29, 2018, ISBN 978-3-89318-078-3 on OpenProceedings.org. Distribution of this paper is permitted under the terms of the Creative Commons license CC-by-nc-nd 4.0. </span></p><p class="c25"><span class="c2">u</span><span class="c51">3</span><span class="c2">p</span><span class="c51">2 </span></p><p class="c25"><span class="c2">p</span><span class="c51">1 </span><span class="c98">u</span><span class="c51">1 </span><span class="c98">u</span><span class="c51">2 </span><span class="c2">p</span><span class="c51">1 </span><span class="c2">u</span><span class="c51">1 </span><span class="c2">Group LSP </span></p><p class="c25"><span class="c3">Figure 1: A kGNN query (k = 2): {u</span><span class="c18">1</span><span class="c3">,u</span><span class="c18">2</span><span class="c3">,u</span><span class="c18">3</span><span class="c3">} retrieves p</span><span class="c18">1</span><span class="c3">,p</span><span class="c18">2 </span><span class="c3">as top-2 locations </span></p><p class="c25"><span class="c3">kGNN query offers richer semantics with broader applications in spatial databases [</span><span class="c22">18</span><span class="c3">, </span><span class="c22">19</span><span class="c3">, </span><span class="c22">24</span><span class="c3">, </span><span class="c22">25</span><span class="c3">, </span><span class="c22">28</span><span class="c3">]. </span></p><p class="c6"><span class="c3">We consider four privacy concerns that arise in the kGNN query scenario. Privacy I: every user&rsquo;s location privacy against LSP since location can reveal the private information of users. Privacy II: query privacy and answer privacy against LSP be- cause the query discloses the combination of users&rsquo; locations and the relationship between users, and the query answer such as a meeting place may disclose the nature of the meeting or event. Privacy III: LSP&rsquo;s data privacy against users. LSP&rsquo;s database is the valuable and protected business asset [</span><span class="c22">8</span><span class="c3">, </span><span class="c22">12</span><span class="c3">, </span><span class="c22">33</span><span class="c3">] and the prin- ciple of least privilege [</span><span class="c22">29</span><span class="c3">] applies where no more information than the requested query answer should be returned to the users. Another reason for this privacy is the pay-per-result model [</span><span class="c22">8</span><span class="c3">, </span><span class="c22">33</span><span class="c3">] where the users who pay for k results should not receive more than k results. Privacy IV: every user&rsquo;s location privacy against other users because users might not trust other users. For exam- ple, two business competitors like to query some meeting places but want to hide their own locations from each other. The most hostile environment is the full user collusion where n &minus; 1 users in the query collude to infer the location of the remaining user. In Figure </span><span class="c5">1</span><span class="c3">, for example, colluding u</span><span class="c1">2</span><span class="c7">,u</span><span class="c1">3 </span><span class="c7">can infer thatu</span><span class="c1">1 </span><span class="c7">is located </span><span class="c3">in the shaded area based on their own locations and the query answer {p</span><span class="c1">1</span><span class="c7">,p</span><span class="c1">2</span><span class="c7">} received. If the shaded area is too small, u</span><span class="c1">1</span><span class="c7">&rsquo;s </span><span class="c3">location privacy may be compromised. Privacy IV is required only in the case of n &gt; 1. </span></p><p class="c6"><span class="c3">Although many solutions, such as [</span><span class="c22">1</span><span class="c3">, </span><span class="c22">3</span><span class="c3">, </span><span class="c22">12</span><span class="c3">, </span><span class="c22">13</span><span class="c3">, </span><span class="c22">17</span><span class="c3">, </span><span class="c22">21</span><span class="c3">, </span><span class="c22">26</span><span class="c3">, </span><span class="c22">27</span><span class="c3">, </span><span class="c22">30</span><span class="c3">, </span><span class="c22">34</span><span class="c3">, </span><span class="c22">36</span><span class="c3">, </span><span class="c22">37</span><span class="c3">], are proposed for the single user query (i.e., n = 1), only a few works addressed the group query (i.e., n &gt; 1) [</span><span class="c22">2</span><span class="c3">, </span><span class="c22">14</span><span class="c3">] but none of them achieves all four privacy concerns. Most existing work achieved Privacy I through returning candidate answers (e.g., [</span><span class="c22">3</span><span class="c3">, </span><span class="c22">13</span><span class="c3">, </span><span class="c22">14</span><span class="c3">, </span><span class="c22">17</span><span class="c3">, </span><span class="c22">21</span><span class="c3">, </span><span class="c22">26</span><span class="c3">, </span><span class="c22">30</span><span class="c3">]) or approximate answers (e.g., [</span><span class="c22">1</span><span class="c3">, </span><span class="c22">2</span><span class="c3">, </span><span class="c22">34</span><span class="c3">, </span><span class="c22">37</span><span class="c3">]). However, returning candidate answers not only increases the communication cost but also violates Privacy III, while returning approximate answers degrades the answer utility as well as violates Privacy II since LSP knows the query answer that users obtained. [</span><span class="c22">12</span><span class="c3">, </span><span class="c22">27</span><span class="c3">, </span><span class="c22">36</span><span class="c3">] achieve Privacy I-III in </span></p><p class="c25"><span class="c2">2GNN query </span></p><p class="c25"><span class="c2">p</span><span class="c51">1, </span><span class="c2">p</span><span class="c51">2 </span></p><p class="c50"><span class="c2">pp</span><span class="c51">3 2 </span><span class="c2">p</span><span class="c51">6</span><span class="c2">p</span><span class="c51">4</span><span class="c2">u</span><span class="c51">3</span><span class="c98">u</span><span class="c51">2 </span><span class="c98">p</span><span class="c51">5 </span></p><p class="c148"><span class="c3">the single user query case by heavily relying on pre-computing the query answers for all queries. These approaches are not applicable to the group query where the number of possible queries is large. A more detailed discussion of related work is presented in Section </span><span class="c5">9</span><span class="c3">. </span></p><p class="c147"><span class="c3">In this paper, we design a privacy preserving approach to the kGNN query for the general case of n &ge; 1 while protecting Privacy I-IV. Our approach has the following novelties. First, it eliminates the need for pre-computing all query answers in order to address the privacy issues, while producing the exact answer. Hence, our approach can easily handle a dynamic database on LSP. Second, forPrivacy IV we consider the most hostile environ- ment, called full user collusion, where n &minus; 1 users may collude to infer the location of the remaining user. Third, we aim to reduce user computational cost and communication cost at a reasonable overhead on LSP, which particularly makes sense in the mobile user scenario. Fourth, though we consider kGNN, the proposed privacy preserving approach can be easily adopted to any group query because it treats the query answering (i.e., kGNN) as a black box. For example, our approach works with any choice of aggregate cost function F and other location based group queries; to solve the privacy preserving meeting location determination (PPMLD) [</span><span class="c22">5</span><span class="c3">, </span><span class="c22">16</span><span class="c3">, </span><span class="c22">31</span><span class="c3">], we can replace the black box for kGNN in our approach with any existing (non-privacy preserving) meeting location determination algorithm. </span></p><p class="c126"><span class="c3">The rest of the paper is structured as follows. </span></p><p class="c153"><span class="c3">&bull; Section </span><span class="c5">2 </span><span class="c3">formulates the privacy preserving kGNN query problem, called PPGNN, where n users jointly retrieve k-nearest neighbors from LSP while meeting the require- ments of Privacy I-IV. </span></p><p class="c138"><span class="c3">&bull; Section </span><span class="c5">3 </span><span class="c3">proposes a solution to PPGNN with n = 1. To our knowledge, this is the first work that eliminates the need for pre-computing all the query answers to achieve Privacy I-III. </span></p><p class="c135"><span class="c3">&bull; Section </span><span class="c5">4 </span><span class="c3">proposes a solution to PPGNN with n &ge; 1 while achieving Privacy I-III. </span></p><p class="c85"><span class="c3">&bull; Section </span><span class="c5">5 </span><span class="c3">extends the solution to PPGNN with n &ge; 1 to achieve Privacy I-IV under the full user collusion as- sumption. As far as we know, this is the first solution that achieves Privacy I-IV. </span></p><p class="c139"><span class="c3">&bull; Section </span><span class="c5">6 </span><span class="c3">presents an optimization of the PPGNN solution, denoted PPGNN-OPT, to further reduce the communica- tion cost and user computational cost. </span></p><p class="c169"><span class="c3">&bull; Section </span><span class="c5">7 </span><span class="c3">theoretically analyzes the performance of the PPGNN solution and PPGNN-OPT solution. </span></p><p class="c85"><span class="c3">&bull; Section </span><span class="c5">8 </span><span class="c3">presents empirical results on a real-world dataset, showing that the proposed approaches are highly commu- nication efficient for the privacy guarantees achieved. </span></p><p class="c167"><span class="c3">&bull; Section </span><span class="c5">9 </span><span class="c3">reviews the related work. </span></p><p class="c67"><span class="c32">2 PROBLEM STATEMENT </span><span class="c3">We formally define the problem studied in this paper. Table </span><span class="c5">1 </span><span class="c3">summarizes the frequently used notations. We assume that LSP owns a database of Points of Interest (POIs) where each POI has a location (e.g., latitude and longitude) and other associated in- formation, and each user has a location. Both users and LSP are semi-honest: they follow the protocol exactly as specified, but may try to infer others&rsquo; private information. Users can acquire their locations from satellites anonymously. A base station is re- sponsible for the communication within users and between users and LSP (e.g., mobile communication provider). The base station </span></p><p class="c25 c91"><span class="c3">Table 1: Summary of notations </span></p><p class="c120"><span class="c3">Notation Description n the number of users in the group d anonymity parameter for Privacy I &delta; anonymity parameter for Privacy II &theta;</span><span class="c1">0 </span><span class="c7">privacy parameter for Privacy IV </span><span class="c3">l</span><span class="c1">i</span><span class="c48">,</span><span class="c1">&lowast; </span><span class="c7">real location of u</span><span class="c1">i </span><span class="c3">C</span><span class="c18">&lowast; </span><span class="c3">real query {l</span><span class="c18">1</span><span class="c35">,</span><span class="c18">&lowast;</span><span class="c3">, &middot;&middot;&middot; ,l</span><span class="c18">n</span><span class="c35">,</span><span class="c18">&lowast;</span><span class="c3">} of the group L</span><span class="c1">i </span><span class="c7">u</span><span class="c1">i</span><span class="c7">&rsquo;s location set </span><span class="c3">l</span><span class="c1">i</span><span class="c48">,</span><span class="c1">j </span><span class="c7">j-th location in L</span><span class="c1">i </span><span class="c7">&nbsp;&#772;n, </span><span class="c3">&nbsp;&#772;</span><span class="c7">d partition parameters </span><span class="c3">[</span><span class="c14">v</span><span class="c3">] encrypted indicator vector for C</span><span class="c1">&lowast; </span><span class="c3">A answer matrix for all candidate queries N the product of two large primes determined by pk </span></p><p class="c149"><span class="c3">will not collude with LSP, and there is a secure communication channel (e.g., Tor</span><span class="c86">1</span><span class="c3">) so that LSP cannot infer users&rsquo; locations by IP addresses. We also assume that LSP does not collude with users. This assumption is reasonable because the penalty of collusion involving LSP is very high, including losing the trust of users and being prosecuted. </span></p><p class="c89"><span class="c32">2.1 kGNN Query </span><span class="c3">Let D = {p</span><span class="c18">1</span><span class="c3">, &middot;&middot;&middot; ,p</span><span class="c1">D</span><span class="c7">} be a database (owned by LSP) of D POIs, </span><span class="c3">and C</span><span class="c1">&lowast; </span><span class="c7">= {l</span><span class="c1">1</span><span class="c48">,</span><span class="c1">&lowast;</span><span class="c7">, &middot;&middot;&middot; ,l</span><span class="c1">n</span><span class="c48">,</span><span class="c1">&lowast;</span><span class="c7">} be the locations of n users. Both D and </span><span class="c3">C</span><span class="c1">&lowast; </span><span class="c7">are in a metric space where a spatial distance function dis is </span><span class="c3">defined for any two locations, e.g., Euclidean distance [</span><span class="c22">24</span><span class="c3">, </span><span class="c22">25</span><span class="c3">], road-network distance [</span><span class="c22">38</span><span class="c3">]. Let F be a monotonically increasing aggregate function, </span></p><p class="c163"><span class="c3">F(p,C</span><span class="c1">&lowast;</span><span class="c7">) = F(dis(p,l</span><span class="c1">1</span><span class="c48">,</span><span class="c1">&lowast;</span><span class="c7">), &middot;&middot;&middot; ,dis(p,l</span><span class="c1">n</span><span class="c48">,</span><span class="c1">&lowast;</span><span class="c7">)) (1) </span><span class="c3">where p can be any POI in D. Commonly used F includes sum, max andmin. For example, with sum the query retrieves a meet- ing place with the minimum total distance to the users, and with max the query retrieves a collection place for the troops that leads to the earliest meet time (by minimizing the maximum dis- tance for every troop to reach that place [</span><span class="c22">25</span><span class="c3">]), and withmin the query retrieves a place that leads to the earliest time for any user to reach that place. In general, the query finds the k best POIs p from D in an ascending order of F(p,C</span><span class="c1">&lowast;</span><span class="c7">), as defined below. </span></p><p class="c39"><span class="c3">Definition 2.1 (kGNN query [</span><span class="c22">28</span><span class="c3">]). Given a spatial database D,n query locations C</span><span class="c18">&lowast;</span><span class="c3">, distance functiondis, and aggregate function F, a kGNN query (k &le; D) retrieves a subset P = {p</span><span class="c1">1</span><span class="c7">, &middot;&middot;&middot; ,p</span><span class="c1">k</span><span class="c3">} from D, such that &forall;p</span><span class="c1">i </span><span class="c7">&isin; P and &forall;p &isin; D &minus; P, F(p</span><span class="c1">i</span><span class="c7">, C</span><span class="c1">&lowast;</span><span class="c7">) &le; F(p, C</span><span class="c1">&lowast;</span><span class="c7">), </span><span class="c3">and for 1 &le; i &lt; j &le; k, F(p</span><span class="c18">i</span><span class="c3">, C</span><span class="c18">&lowast;</span><span class="c3">) &le; F(p</span><span class="c18">j</span><span class="c3">,C</span><span class="c18">&lowast;</span><span class="c3">).D </span></p><p class="c49"><span class="c32">2.2 Privacy Preserving kGNN Query </span></p><p class="c132"><span class="c3">Definition 2.2 (Privacy preserving kGNN query, or PPGNN). Let D and C</span><span class="c18">&lowast; </span><span class="c3">be those in Definition </span><span class="c5">2.1</span><span class="c3">. A kGNN query is privacy preserving if the following conditions are satisfied: </span></p><p class="c137 c144"><span class="c3">(1) Privacy I: &forall;i &isin; [1,n], each user u</span><span class="c1">i</span><span class="c7">&rsquo;s location l</span><span class="c1">i</span><span class="c48">,</span><span class="c1">&lowast; </span><span class="c7">is indis- </span><span class="c3">tinguishable from d equally likely locations by LSP, d &gt; 1; </span></p><p class="c77"><span class="c3">(2) Privacy II: the query location C</span><span class="c1">&lowast; </span><span class="c7">and its answer are indis- </span><span class="c3">tinguishable from &delta; equally likely candidates by LSP, &delta; &ge; d; </span></p><p class="c29 c137"><span class="c3">(3) Privacy III: the users can learn nothing more than the requested answer to the query C</span><span class="c1">&lowast;</span><span class="c7">. </span></p><p class="c29 c107"><span class="c3">(4) Privacy IV: &forall;i &isin; [1,n], u</span><span class="c1">i</span><span class="c7">&rsquo;s location l</span><span class="c1">i</span><span class="c48">,</span><span class="c1">&lowast; </span><span class="c7">is hidden in a </span><span class="c3">region from other users, where the size of the region is no less </span></p><p class="c64"><span class="c36">1</span><span class="c12">https://www.torproject.org/ </span></p><p class="c130"><span class="c88">278 </span></p><p class="c6"><span class="c3">than&theta;</span><span class="c1">0 </span><span class="c7">fraction of the size of the whole location space, &theta;</span><span class="c1">0 </span><span class="c7">&isin; (0,1]. </span><span class="c3">Under the full user collusion assumption, this property should hold even if any n &minus;1 users collude, by sharing their locations, to infer the remaining user&rsquo;s location with the help of the query answer received. D </span></p><p class="c6"><span class="c3">Condition (1) guarantees that the probability for LSP to infer a user&rsquo;s location is </span><span class="c9">1</span><span class="c18">d </span><span class="c30">. Condition (2) guarantees that the probability </span><span class="c3">for LSP to infer the group&rsquo;s query, i.e., all users&rsquo; locations, as well as the query answer, is </span><span class="c9">1</span><span class="c18">&delta; </span><span class="c30">, where &delta; &ge; d. Condition (3) guarantees </span><span class="c3">that the users learn only the query answer as defined by the query, in order to protect the LSP&rsquo;s private database. Condition (4) guarantees that any user&rsquo;s location can not be inferred by other users. The strength of these privacy guarantees depends on the setting of the privacy parameters (d,&delta;,&theta;</span><span class="c1">0</span><span class="c7">), which are </span><span class="c3">specified by the users. </span></p><p class="c25"><span class="c32">3 SINGLE USER QUERY </span><span class="c3">In this section, we consider PPGNN with single user, i.e., n = 1. In this case, there is no Privacy IV, and &delta; = d. Section </span><span class="c5">3.1 </span><span class="c3">gives some background knowledge about the generalized Paillier cryptosystem [</span><span class="c22">10</span><span class="c3">]. Section </span><span class="c5">3.2 </span><span class="c3">presents our solution. </span></p><p class="c25"><span class="c32">3.1 Generalized Paillier Cryptosystem </span><span class="c3">Generalized Paillier cryptosystem&epsilon;</span><span class="c18">s </span><span class="c3">(s &ge; 1) [</span><span class="c22">10</span><span class="c3">] is a probabilistic asymmetric encryption scheme that provides semantic security. Let Z</span><span class="c1">N </span><span class="c36">s </span><span class="c3">and Z</span><span class="c9">&lowast;</span><span class="c18">N </span><span class="c95">s </span><span class="c30">be the residue class ring module N</span><span class="c9">s </span><span class="c3">and the prime residue class group module N</span><span class="c9">s</span><span class="c3">, respectively. </span></p><p class="c6"><span class="c3">Generalized Paillier cryptosystem is composed of three algo- rithms (Gen, Enc, Dec): (1) given a security parameter keysize, the key generation algorithm (sk,pk) = Gen(keysize) returns se- cret keysk and public keypk. N is the product of two large primes determined by pk. (2) The encryption algorithm c = Enc(x,pk) maps a plaintext x &isin; Z</span><span class="c1">N </span><span class="c36">s </span><span class="c3">to a ciphertext c &isin; Z</span><span class="c9">&lowast;</span><span class="c18">N </span><span class="c95">s+1 </span><span class="c30">using pk. </span><span class="c3">(3) The decryption algorithm x = Dec(c,sk) executes reverse operation of encryption by sk, obtaining plaintext x. The exact construction of Enc and Dec, which can be found in [</span><span class="c22">10</span><span class="c3">], is not important for this work, but the following homomorphism properties of the generalized Paillier cryptosystem are used by our solutions. For simplicity, we omit the public key pk in the Enc algorithm. Let x</span><span class="c1">1</span><span class="c7">,x</span><span class="c1">2 </span><span class="c7">denote the plaintexts in Z</span><span class="c1">N </span><span class="c36">s</span><span class="c3">. </span></p><p class="c6"><span class="c3">Homomorphic addition &oplus;: given two ciphertexts Enc(x</span><span class="c1">1</span><span class="c7">), </span><span class="c3">Enc(x</span><span class="c18">2</span><span class="c3">), the ciphertext of the sum x</span><span class="c18">1 </span><span class="c3">+ x</span><span class="c18">2 </span><span class="c3">can be obtained by multiplying the ciphertexts, i.e., </span></p><p class="c50"><span class="c3">Enc(x</span><span class="c1">1</span><span class="c7">) &oplus; Enc(x</span><span class="c1">2</span><span class="c7">) : Enc(x</span><span class="c1">1</span><span class="c7">) &middot; Enc(x</span><span class="c1">2</span><span class="c7">) = Enc(x</span><span class="c1">1 </span><span class="c7">+ x</span><span class="c1">2</span><span class="c7">) (2) </span><span class="c3">Homomorphic multiplication &otimes;: given a plaintext x</span><span class="c18">1 </span><span class="c3">and a ciphertext Enc(x</span><span class="c1">2</span><span class="c7">), the ciphertext of the product x</span><span class="c1">1</span><span class="c7">x</span><span class="c1">2 </span><span class="c7">can be </span><span class="c3">obtained by raising Enc(x</span><span class="c18">2</span><span class="c3">) to the power x</span><span class="c18">1</span><span class="c3">: </span></p><p class="c50"><span class="c3">x</span><span class="c1">1 </span><span class="c7">&otimes; Enc(x</span><span class="c1">2</span><span class="c7">) : Enc(x</span><span class="c1">2</span><span class="c7">)</span><span class="c18">x</span><span class="c61">1 </span><span class="c7">= Enc(x</span><span class="c1">1</span><span class="c7">x</span><span class="c1">2</span><span class="c7">) (3) </span><span class="c3">Homomorphic dot product &#8857;: given a ciphertext vector Enc(</span><span class="c14">v</span><span class="c3">) = (Enc(v</span><span class="c1">1</span><span class="c7">), &middot;&middot;&middot; , Enc(v</span><span class="c1">m</span><span class="c7">))</span><span class="c18">T </span><span class="c7">and a plaintext vector x = </span><span class="c3">(x</span><span class="c1">1</span><span class="c7">, &middot;&middot;&middot; ,x</span><span class="c1">m</span><span class="c7">), the ciphertext of the dot product </span><span class="c66">v </span><span class="c7">&middot; x can be ob- </span><span class="c3">tained by: </span></p><p class="c25"><span class="c3">x &#8857; Enc(</span><span class="c14">v</span><span class="c3">) : (x</span><span class="c1">1 </span><span class="c7">&otimes; Enc(v</span><span class="c1">1</span><span class="c7">))&oplus;&middot;&middot;&middot;&oplus;(x</span><span class="c1">m </span><span class="c7">&otimes; Enc(v</span><span class="c1">m</span><span class="c7">)) </span></p><p class="c25"><span class="c3">= Enc(x</span><span class="c1">1</span><span class="c7">v</span><span class="c1">1 </span><span class="c7">+ &middot;&middot;&middot; + x</span><span class="c1">m</span><span class="c7">v</span><span class="c1">m</span><span class="c7">) (4) </span><span class="c3">= Enc(x &middot; </span><span class="c14">v</span><span class="c3">) </span></p><p class="c6"><span class="c3">For simplicity, we write Enc(x) with &epsilon;</span><span class="c1">1 </span><span class="c7">as [x]. One applica- </span><span class="c3">tion of Eqn (</span><span class="c5">4</span><span class="c3">) is privately selecting the i-th element in a vec- tor x without disclosing the value of i. Specifically, let [</span><span class="c14">v</span><span class="c3">] = </span></p><p class="c42"><span class="c87">execute queries: , = 0, 0, 1, 0 </span><span class="c27">/ </span><span class="c15">0 $</span><span class="c123">% </span><span class="c15">0($</span><span class="c123">&#39;</span><span class="c15">) 0 $</span><span class="c123">( </span><span class="c15">0($</span><span class="c123">)</span><span class="c15">) </span></p><p class="c25"><span class="c87">+</span><span class="c11">% </span><span class="c87">+</span><span class="c11">&#39; </span><span class="c87">+</span><span class="c11">( </span><span class="c87">+</span><span class="c11">) </span></p><p class="c25"><span class="c143">User LSP </span></p><p class="c25"><span class="c87">(+</span><span class="c11">%</span><span class="c87">,+</span><span class="c11">&#39;</span><span class="c87">,+</span><span class="c11">(</span><span class="c87">,+</span><span class="c11">)</span><span class="c87">) </span><span class="c115">&#10752; </span><span class="c68">, =[+</span><span class="c11">(</span><span class="c87">] </span><span class="c3">Figure 2: Single user query example (l</span><span class="c1">3 </span><span class="c7">is real) </span></p><p class="c6"><span class="c3">([v</span><span class="c18">1</span><span class="c3">], &middot;&middot;&middot; , [v</span><span class="c18">m</span><span class="c3">])</span><span class="c9">T </span><span class="c3">where v</span><span class="c18">i </span><span class="c3">= 1 and v</span><span class="c18">j </span><span class="c3">= 0 for all j i. Eqn (</span><span class="c5">4</span><span class="c3">) becomes x &#8857; [</span><span class="c14">v</span><span class="c3">] = [x &middot;</span><span class="c14">v</span><span class="c3">] = [x</span><span class="c1">i</span><span class="c7">], which returns x</span><span class="c1">i </span><span class="c7">in ciphertext. </span><span class="c3">We will use this private selection to design our solution. </span></p><p class="c25"><span class="c32">3.2 Proposed Solution </span><span class="c3">Figure </span><span class="c5">2 </span><span class="c3">shows the idea of our solution through a running ex- ample. The user sends a location set {l</span><span class="c18">1</span><span class="c3">,l</span><span class="c18">2</span><span class="c3">,l</span><span class="c18">3</span><span class="c3">,l</span><span class="c18">4</span><span class="c3">} to LSP, where d = 4, as well as an encrypted indicator vector ([0],[0], [1], [0]) that implicitly specifies thatl</span><span class="c1">3 </span><span class="c7">is the real user location. LSP calcu- </span><span class="c3">lates the query for every location in the location set, producing the answers a</span><span class="c1">1</span><span class="c7">,a</span><span class="c1">2</span><span class="c7">,a</span><span class="c1">3</span><span class="c7">,a</span><span class="c1">4</span><span class="c7">, and privately selects a</span><span class="c1">3 </span><span class="c7">through the </span><span class="c3">result [a</span><span class="c1">3</span><span class="c7">] according to the homomorphism properties. This so- </span><span class="c3">lution has three stages: query generation, query processing, and answer decryption. We discuss each stage in details. We denote the user&rsquo;s real location by l</span><span class="c1">&lowast;</span><span class="c7">. </span></p><p class="c6"><span class="c3">Query Generation. At first, the user randomly selects d &minus; 1 dummy locations from the location space and constructs a location set L = {l</span><span class="c1">1</span><span class="c7">, &middot;&middot;&middot; ,l</span><span class="c1">d</span><span class="c3">} containing the user creates an indicator vector </span><span class="c14">v </span><span class="c3">the real location = (v</span><span class="c1">1</span><span class="c7">, &middot;&middot;&middot; ,v</span><span class="c1">d</span><span class="c3">)</span><span class="c9">T </span><span class="c3">: </span></p><p class="c25"><span class="c3">l</span><span class="c1">&lowast;</span><span class="c7">. Then </span></p><p class="c25"><span class="c3">v</span><span class="c18">i </span><span class="c3">= </span></p><p class="c25"><span class="c87">private selection: </span></p><p class="c25"><span class="c3">{</span><span class="c7">1, l</span><span class="c1">i </span><span class="c7">= l</span><span class="c1">&lowast; </span></p><p class="c25"><span class="c3">0, otherwise </span><span class="c30">(5) </span></p><p class="c6"><span class="c3">After that, the user generates (sk,pk) by calling the key gener- ation algorithm with the security parameter keysize (e.g., the most commonly used is 1024 bits [</span><span class="c22">23</span><span class="c3">]), and executes element- wise encryption algorithm on</span><span class="c14">v</span><span class="c3">, obtaining an encrypted [</span><span class="c14">v</span><span class="c3">] = ([v</span><span class="c1">1</span><span class="c7">], &middot;&middot;&middot; , [v</span><span class="c1">d</span><span class="c3">]). Finally, the user sends {k,L,pk,[</span><span class="c14">v</span><span class="c3">]} to LSP, where k is the number of POIs to retrieve. </span></p><p class="c50"><span class="c3">Query Processing. After receiving the user&rsquo;s query, LSP com- putes the kNN query for each location in the location set, result- ing in d query answers, a</span><span class="c18">1</span><span class="c3">,&middot;&middot;&middot; ,a</span><span class="c1">d</span><span class="c3">, where each query answer is a list of k POIs. The kNN query is computed on plaintext, so any plaintext solution forkNN query, such as [</span><span class="c22">24</span><span class="c3">], can be applied. We assume that integers, a</span><span class="c1">i </span><span class="c3">each query </span><span class="c7">= (a</span><span class="c1">i</span><span class="c48">,</span><span class="c1">1</span><span class="c7">, &middot;&middot;&middot; ,a</span><span class="c3">answer </span><span class="c1">i</span><span class="c48">,</span><span class="c1">m</span><span class="c7">)</span><span class="c18">T</span><span class="c7">, </span><span class="c3">a</span><span class="c18">i </span><span class="c7">such </span><span class="c3">is represented </span><span class="c7">that </span><span class="c3">by a vector of </span><span class="c7">every element is less </span><span class="c3">than N, where m is the maximum number of integers required for any of the d answers. If the number of integers encoded for a query answer is less than m, 0&rsquo;s are padded as placeholders. </span></p><p class="c6"><span class="c3">Let A</span><span class="c9">m&times;d </span><span class="c3">= (a</span><span class="c1">1</span><span class="c7">,&middot;&middot;&middot; ,a</span><span class="c1">d</span><span class="c3">) be the query answer matrix. The next theorem suggests that LSP can obtain the encrypted query answer for the real location l</span><span class="c1">&lowast; </span><span class="c7">by a private selection using A and </span><span class="c3">[</span><span class="c14">v</span><span class="c3">]. The encrypted query answer is returned to the user. </span></p><p class="c50"><span class="c3">Theorem 3.1 (Private Selection). Given an encrypted indica- tor vector [</span><span class="c14">v</span><span class="c3">] = ([v</span><span class="c1">1</span><span class="c7">], &middot;&middot;&middot; ,[v</span><span class="c1">d</span><span class="c3">])</span><span class="c9">T </span><span class="c3">[0] for all j i, and the answer matrix such that [v</span><span class="c1">i</span><span class="c7">] = [1] and [v</span><span class="c1">j</span><span class="c7">] = </span><span class="c3">A</span><span class="c9">m&times;d </span><span class="c3">= (a</span><span class="c1">1</span><span class="c7">, &middot;&middot;&middot; ,a</span><span class="c1">d</span><span class="c3">), then </span></p><p class="c25"><span class="c88">279 </span></p><p class="c25"><span class="c87">! = ($</span><span class="c11">%</span><span class="c87">, $</span><span class="c11">&#39; </span><span class="c87">$</span><span class="c11">(</span><span class="c87">,$</span><span class="c11">)</span><span class="c87">) </span></p><p class="c25"><span class="c87">+</span><span class="c11">( </span></p><p class="c25"><span class="c3">[a</span><span class="c18">i</span><span class="c3">] is computed by A [</span><span class="c14">v</span><span class="c3">] defined as follows: </span></p><p class="c25"><span class="c3">A [</span><span class="c14">v</span><span class="c3">] = </span></p><p class="c42"><span class="c3">a</span><span class="c1">1</span><span class="c48">,</span><span class="c1">1 </span><span class="c7">... &middot;&middot;&middot; </span><span class="c3">.</span><span class="c7">.. a</span><span class="c1">d</span><span class="c48">,</span><span class="c1">1 </span><span class="c3">.</span><span class="c7">.. </span><span class="c3">a</span><span class="c1">1</span><span class="c48">,</span><span class="c1">m </span><span class="c7">&middot;&middot;&middot; a</span><span class="c1">d</span><span class="c48">,</span><span class="c1">m </span></p><p class="c25"><span class="c3">[v.</span><span class="c7">.. </span></p><p class="c25"><span class="c1">1</span><span class="c7">] </span></p><p class="c25"><span class="c3">[v</span><span class="c1">d</span><span class="c3">] </span></p><p class="c25"><span class="c3">= </span></p><p class="c25"><span class="c3">[a</span><span class="c18">1</span><span class="c35">,</span><span class="c18">1</span><span class="c3">v</span><span class="c18">1 </span><span class="c3">+ &middot;&middot;&middot; .</span><span class="c7">.. </span></p><p class="c25"><span class="c3">+ a</span><span class="c1">d</span><span class="c48">,</span><span class="c1">1</span><span class="c3">v</span><span class="c1">d</span><span class="c3">] </span></p><p class="c25"><span class="c3">[a</span><span class="c18">1</span><span class="c35">,</span><span class="c18">m</span><span class="c3">v</span><span class="c18">1 </span><span class="c3">+ &middot;&middot;&middot; + a</span><span class="c1">d</span><span class="c48">,</span><span class="c1">m</span><span class="c3">v</span><span class="c1">d</span><span class="c3">] </span></p><p class="c25"><span class="c3">= </span></p><p class="c25"><span class="c3">[0 + &middot;&middot;&middot; + a</span><span class="c1">i</span><span class="c48">,</span><span class="c1">1 </span><span class="c3">.</span><span class="c7">.. </span></p><p class="c25"><span class="c7">+ &middot;&middot;&middot; + 0] </span></p><p class="c25"><span class="c3">= </span></p><p class="c42"><span class="c3">[a</span><span class="c1">i</span><span class="c48">,</span><span class="c1">1</span><span class="c7">] </span><span class="c3">.</span><span class="c7">.. </span></p><p class="c25"><span class="c3">= [a</span><span class="c1">i</span><span class="c7">].D </span><span class="c3">[0 + &middot;&middot;&middot; + a</span><span class="c1">i</span><span class="c48">,</span><span class="c1">m </span><span class="c7">+ &middot;&middot;&middot; + 0] </span></p><p class="c25"><span class="c3">[a</span><span class="c1">i</span><span class="c48">,</span><span class="c1">m</span><span class="c7">] </span></p><p class="c6"><span class="c3">The notation represents the homomorphic matrix multi- plication, which executes homomorphic dot product operations in Eqn (</span><span class="c5">4</span><span class="c3">) between each row in A and [</span><span class="c14">v</span><span class="c3">]. </span></p><p class="c6"><span class="c3">Answer Decryption. After receiving [a</span><span class="c18">i</span><span class="c3">], the user can exe- cute the decryption algorithm on the ciphertext to get the exact query answer a</span><span class="c1">i </span><span class="c7">for l</span><span class="c1">&lowast;</span><span class="c7">. </span></p><p class="c6"><span class="c3">In this solution, Privacy I is satisfied by anonymizing the user&rsquo;s real location among d locations. Privacy II is satisfied because the real query answer is anonymized in d query answers (note &delta; = d when n = 1) and the selection process is private. Also, LSP returns only the query answer for l</span><span class="c1">&lowast;</span><span class="c7">, so Privacy III is </span><span class="c3">satisfied. </span></p><p class="c25"><span class="c32">4 GROUP QUERY </span><span class="c3">We now present the PPGNN solution for the group query where n &ge; 1, which subsumes the solution in Section </span><span class="c5">3 </span><span class="c3">as a special case. Section </span><span class="c5">4.1 </span><span class="c3">presents a candidate query generation method that helps satisfy Privacy II. Section </span><span class="c5">4.2 </span><span class="c3">describes the PPGNN solution. Section </span><span class="c5">4.3 </span><span class="c3">proves the protection of Privacy I-III. The protection of Privacy IV is addressed in Section </span><span class="c5">5</span><span class="c3">. </span></p><p class="c6"><span class="c3">Recall that the real location of each user u</span><span class="c18">i </span><span class="c3">is denoted as l</span><span class="c1">i</span><span class="c48">,</span><span class="c1">&lowast;</span><span class="c7">, 1 &le; i &le; n, and l</span><span class="c1">i</span><span class="c48">,</span><span class="c1">&lowast; </span><span class="c7">is hidden in the location set L</span><span class="c1">i </span><span class="c7">= </span><span class="c3">{l</span><span class="c18">i</span><span class="c35">,</span><span class="c18">1</span><span class="c3">, &middot;&middot;&middot; ,l</span><span class="c1">i</span><span class="c48">,</span><span class="c1">d </span><span class="c3">}. From L</span><span class="c18">i</span><span class="c3">, 1 &le; i &le; n, LSP can obtain a set of can- didate queries, where each candidate query is a set of n locations that contains exactly one location from every L</span><span class="c1">i</span><span class="c7">. One candidate </span><span class="c3">query is the real query, denoted by C</span><span class="c18">&lowast; </span><span class="c3">= {l</span><span class="c18">1</span><span class="c35">,</span><span class="c18">&lowast;</span><span class="c3">, &middot;&middot;&middot; ,l</span><span class="c18">n</span><span class="c35">,</span><span class="c18">&lowast;</span><span class="c3">}. </span></p><p class="c6"><span class="c3">Naive Solution. With &delta; &ge; d, one straightforward method to satisfy both Privacy I and Privacy II is that every user u</span><span class="c1">i </span><span class="c3">generates a length &delta;, instead of length d, location set L</span><span class="c18">i</span><span class="c3">, and all users arrange their real locations on the same position in L</span><span class="c1">i</span><span class="c7">, 1 &le; i &le; n. Then LSP can extract one candidate query from </span><span class="c3">the same position in the n location sets, resulting in &delta; candidate queries. One of these candidate queries is the real query. How- ever, this solution incurs the additional computational cost to generate &delta; &minus; d extra dummy locations (e.g., using the dummy generation algorithm [</span><span class="c22">20</span><span class="c3">, </span><span class="c22">22</span><span class="c3">]) for every user, and the additional communication cost to send the extra dummy locations to LSP. With users&rsquo; computational power being limited (e.g., mobile de- vices) and the communication bandwidth being precious, this approach is not practical. To address this special requirement in the mobile user scenario, we propose a solution that aims to reduce the user computational cost and the communication cost at some overhead of the LSP computational cost. </span></p><p class="c25"><span class="c32">4.1 Candidate Query Generation </span><span class="c3">Our solution keeps the location set L</span><span class="c1">i </span><span class="c7">at the size d but defines a </span><span class="c3">novel protocol for LSP to generate at least &delta; candidate queries </span></p><p class="c50"><span class="c3">from elements, the dlocation </span><span class="c9">n </span><span class="c3">candidate sets queries L</span><span class="c18">i</span><span class="c3">, 1 &le; i can &le; n. With each L</span><span class="c18">i </span><span class="c3">having d be generated by the cartesian product be specified </span><span class="c9">n</span><span class="c18">i=1 </span><span class="c3">by </span><span class="c30">L</span><span class="c3">the </span><span class="c18">i</span><span class="c3">. We users. </span></p><p class="c25"><span class="c3">assume&delta; &le; d</span><span class="c9">n</span><span class="c3">, otherwise, a largerd should </span></p><p class="c6"><span class="c3">Clearly, generating the maximum number of candidate queries, d</span><span class="c9">n</span><span class="c3">, will satisfy Privacy II, but if&delta; &#8810; d</span><span class="c9">n</span><span class="c3">, this means that LSP will compute many unnecessary queries. Our method will generate a minimum number &delta;</span><span class="c9">&prime; </span><span class="c3">of candidate queries such that &delta;</span><span class="c9">&prime; </span><span class="c3">&ge; &delta;, thus, satisfying Privacy II. To this end, we partition the user group every { &#772;n, d} </span><span class="c30">&nbsp;&#772;</span><span class="c3">into &alpha; subgroups location set L</span><span class="c18">i </span><span class="c3">of the into &beta; size &nbsp;&#772;n segments = of ( &#772;n</span><span class="c18">1</span><span class="c3">, the &middot;&middot;&middot; size , &nbsp;&#772;n</span><span class="c18">&alpha; </span><span class="c3">d </span><span class="c30">&nbsp;&#772;</span><span class="c3">), = and ( d</span><span class="c18">1</span><span class="c3">, </span><span class="c30">&nbsp;&#772;</span><span class="c3">partition </span></p><p class="c50"><span class="c3">&middot;&middot;&middot; , d</span><span class="c30">&nbsp;&#772;</span><span class="c1">&beta;</span><span class="c3">). is called partition parameters and is known to both users and LSP. We will determine these parameters shortly. To ensure that the real query will be generated as one of the candidate queries, the following constraint must be satisfied by subgroups and segments: all users arrange their real locations in the same segment, and all users from the same subgroup arrange their real locations on the same position of that segment. Our query generation in Section </span><span class="c5">4.2 </span><span class="c3">will enforce this constraint. </span></p><p class="c50"><span class="c3">Example 4.1. In Figure </span><span class="c5">4a</span><span class="c3">, the user group is partitioned into 2 subgroups 2 segments by by &nbsp;&#772;n d </span><span class="c30">&nbsp;&#772;</span><span class="c3">= = (2, (2,2). 2), and All the users location arrange sets their are real partitioned locations into in se&#1076;ment</span><span class="c1">2</span><span class="c7">, highlight in red. Also, the users in sub&#1076;roup</span><span class="c1">1 </span><span class="c7">arrange </span><span class="c3">the real locations on the 2-nd position of se&#1076;ment</span><span class="c18">2</span><span class="c3">, and the users in sub&#1076;roup</span><span class="c1">2 </span><span class="c7">arrange the real locations on the 1-st position of </span><span class="c3">se&#1076;ment</span><span class="c1">2</span><span class="c7">.D </span></p><p class="c6"><span class="c3">Given the location sets and the partition parameters, LSP gen- erates the candidate queries as follows. Let G</span><span class="c1">i</span><span class="c48">,</span><span class="c1">j</span><span class="c48">,</span><span class="c1">t </span><span class="c7">be the subset </span><span class="c3">of locations from the t-th position of the i-th segment and the j-th subgroup, and let G</span><span class="c1">i</span><span class="c48">,</span><span class="c1">j</span><span class="c48">,</span><span class="c1">: </span><span class="c7">be the subset of locations from the </span><span class="c3">i-th </span><span class="c7">d &#772;</span><span class="c1">i </span><span class="c3">segment and the j-th subgroup. Note that G</span><span class="c1">i</span><span class="c48">,</span><span class="c1">j</span><span class="c48">,</span><span class="c1">: </span><span class="c7">contains locations. See Figure </span><span class="c84">4b </span><span class="c7">for some examples. For 1 &le; i &le; &beta;, </span><span class="c3">LSP computes the candidate queries for the i-th segment by the cartesian product </span></p><p class="c25"><span class="c18">&alpha; </span><span class="c1">j=1 </span></p><p class="c25"><span class="c3">G</span><span class="c1">i</span><span class="c48">,</span><span class="c1">j</span><span class="c48">,</span><span class="c1">: </span><span class="c7">(6) </span></p><p class="c25"><span class="c3">This gives a total there are ( d</span><span class="c18">i</span><span class="c3">)</span><span class="c30">&nbsp;&#772;</span><span class="c9">&alpha; </span><span class="c3">combinations number of for </span><span class="c18">i=1</span><span class="c9">&beta;</span><span class="c3">thei-th </span><span class="c30">( </span><span class="c3">d</span><span class="c30">&nbsp;&#772;</span><span class="c1">i</span><span class="c7">)</span><span class="c18">&alpha; </span><span class="c3">segment. </span><span class="c7">candidate </span><span class="c3">Each </span><span class="c7">queries </span><span class="c3">candidate </span><span class="c7">since </span></p><p class="c6"><span class="c3">query is uniquely identified by a sequence of the indexes (i, j,t) forG</span><span class="c1">i</span><span class="c48">,</span><span class="c1">j</span><span class="c48">,</span><span class="c1">t</span><span class="c7">, and all candidate queries are listed in the lexicographic </span><span class="c3">order of such indexes. We call this list the candidate query list. </span></p><p class="c6"><span class="c3">Figure </span><span class="c5">3c </span><span class="c3">illustrates the cartesian product for each segment, generating a total of 8 candidate queries. Figure </span><span class="c5">3d </span><span class="c3">shows the candidate query list, in which the real query C</span><span class="c18">&lowast; </span><span class="c3">is at the position 7. This position of the real query can be calculated by the users based on the segment and the positions where the real locations are placed in all location sets. However, LSP does not know this position of the real query because the segment and positions for the Determining real locations the are confidentially partition parameters chosen by { &#772;n, the d}. </span><span class="c30">&nbsp;&#772;</span><span class="c3">users. </span></p><p class="c25"><span class="c3">The parti- tion parameters are determined by solving the problem </span></p><p class="c25"><span class="c3">minimize </span></p><p class="c25"><span class="c18">&alpha;</span><span class="c35">,</span><span class="c18">&beta;</span><span class="c35">, </span><span class="c18">d </span><span class="c9">&nbsp;&#772;</span><span class="c30">&delta;</span><span class="c9">&prime; </span><span class="c3">= </span><span class="c9">&beta;</span><span class="c18">i=1</span><span class="c30">( </span><span class="c3">d</span><span class="c30">&nbsp;&#772;</span><span class="c1">i</span><span class="c7">)</span><span class="c18">&alpha; </span><span class="c7">(7) </span><span class="c3">subject to &delta;</span><span class="c9">&prime; </span><span class="c3">&ge; &delta; (8) </span></p><p class="c25"><span class="c18">&beta;</span><span class="c1">i=1 </span><span class="c7">d</span><span class="c3">&nbsp;&#772;</span><span class="c1">i </span><span class="c7">= d (9) </span><span class="c3">&alpha; &isin; N</span><span class="c1">&le;n</span><span class="c7">, &beta; &isin; N</span><span class="c1">&le;d</span><span class="c3">, { d</span><span class="c30">&nbsp;&#772;</span><span class="c1">i</span><span class="c7">}</span><span class="c1">i=1 </span><span class="c18">&beta;</span><span class="c3">&isin; N</span><span class="c1">&le;d </span><span class="c3">(10) </span></p><p class="c25"><span class="c88">280 </span></p><p class="c6"><span class="c17">C</span><span class="c11">1</span><span class="c21">: </span><span class="c17">l</span><span class="c11">1,1 </span><span class="c17">l</span><span class="c11">2,1 </span><span class="c17">l</span><span class="c11">3,1 </span><span class="c17">l</span><span class="c11">4,1 </span><span class="c17">C</span><span class="c11">2</span><span class="c21">: </span><span class="c17">l</span><span class="c11">1,1 </span><span class="c17">l</span><span class="c11">2,1 </span><span class="c17">l</span><span class="c11">3,2 </span><span class="c17">l</span><span class="c11">4,2 </span><span class="c17">C</span><span class="c11">3</span><span class="c21">: </span><span class="c17">l</span><span class="c11">1,2 </span><span class="c17">l</span><span class="c11">2,2 </span><span class="c17">l</span><span class="c11">3,1 </span><span class="c17">l</span><span class="c11">4,1 </span><span class="c17">C</span><span class="c11">4</span><span class="c21">: </span><span class="c17">l</span><span class="c11">1,2 </span><span class="c17">l</span><span class="c11">2,2 </span><span class="c17">l</span><span class="c11">3,2 </span><span class="c17">l</span><span class="c11">4,2 </span><span class="c17">C</span><span class="c11">5</span><span class="c21">: </span><span class="c17">l</span><span class="c11">1,3 </span><span class="c17">l</span><span class="c11">2,3 </span><span class="c17">l</span><span class="c11">3,3 </span><span class="c17">l</span><span class="c11">4,3 </span><span class="c17">C</span><span class="c11">6</span><span class="c21">: </span><span class="c17">l</span><span class="c11">1,3 </span><span class="c17">l</span><span class="c11">2,3 </span><span class="c17">l</span><span class="c11">3,4 </span><span class="c17">l</span><span class="c11">4,4 </span><span class="c17">C</span><span class="c11">7</span><span class="c21">: </span><span class="c17">l</span><span class="c11">1,4 </span><span class="c17">l</span><span class="c11">2,4 </span><span class="c17">l</span><span class="c11">3,3 </span><span class="c17">l</span><span class="c11">4,3 </span><span class="c17">C</span><span class="c11">8</span><span class="c21">: </span><span class="c17">l</span><span class="c11">1,4 </span><span class="c17">l</span><span class="c11">2,4 </span><span class="c17">l</span><span class="c11">3,4 </span><span class="c17">l</span><span class="c11">4,4 </span></p><p class="c25"><span class="c70">segmentsegment</span><span class="c63">1 </span></p><p class="c25"><span class="c63">2 </span></p><p class="c6"><span class="c17">C</span><span class="c11">5</span><span class="c21">: </span><span class="c17">G</span><span class="c11">2,1,1 </span><span class="c17">G</span><span class="c11">2,2,1 </span><span class="c17">C</span><span class="c11">6</span><span class="c21">: </span><span class="c17">G</span><span class="c11">2,1,1 </span><span class="c17">G</span><span class="c11">2,2,2 </span><span class="c17">C</span><span class="c11">7</span><span class="c21">: </span><span class="c17">G</span><span class="c11">2,1,2 </span><span class="c17">G</span><span class="c11">2,2,1 </span><span class="c17">C</span><span class="c11">8</span><span class="c21">: </span><span class="c17">G</span><span class="c11">2,1,2 </span><span class="c17">G</span><span class="c11">2,2,2 </span></p><p class="c25"><span class="c4">(c) </span></p><p class="c25"><span class="c70">segment</span><span class="c63">1 </span><span class="c70">segment</span><span class="c63">2 </span></p><p class="c25"><span class="c4">(a) </span></p><p class="c25"><span class="c70">segment</span><span class="c63">1 </span></p><p class="c25"><span class="c102">segment</span><span class="c57">1 </span><span class="c94">segment</span><span class="c57">2 </span></p><p class="c25"><span class="c79">G</span><span class="c58">1,2,1 </span><span class="c79">G</span><span class="c58">1,2,2 </span><span class="c79">G</span><span class="c58">2,2,1 </span><span class="c79">G</span><span class="c58">2,2,2 </span></p><p class="c25"><span class="c4">(b) </span></p><p class="c6"><span class="c17">C</span><span class="c11">1</span><span class="c21">: </span><span class="c17">G</span><span class="c11">1,1,1 </span><span class="c17">G</span><span class="c11">1,2,1 </span><span class="c17">C</span><span class="c11">2</span><span class="c21">: </span><span class="c17">G</span><span class="c11">1,1,1 </span><span class="c17">G</span><span class="c11">1,2,2 </span><span class="c17">C</span><span class="c11">3</span><span class="c21">: </span><span class="c17">G</span><span class="c11">1,1,2 </span><span class="c17">G</span><span class="c11">1,2,1 </span><span class="c17">C</span><span class="c11">4</span><span class="c21">: </span><span class="c17">G</span><span class="c11">1,1,2 </span><span class="c17">G</span><span class="c11">1,2,2 </span></p><p class="c6"><span class="c17">L</span><span class="c11">1</span><span class="c21">: </span><span class="c17">l</span><span class="c11">1,1 </span><span class="c17">l</span><span class="c11">1,2 </span><span class="c17">l</span><span class="c11">1,3 </span><span class="c17">l</span><span class="c11">1,4 </span><span class="c17">L</span><span class="c11">2</span><span class="c21">: </span><span class="c17">l</span><span class="c11">2,1 </span><span class="c17">l</span><span class="c11">2,2 </span><span class="c17">l</span><span class="c11">2,3 </span><span class="c17">l</span><span class="c11">2,4 </span><span class="c17">L</span><span class="c11">3</span><span class="c21">: </span><span class="c17">l</span><span class="c11">3,1 </span><span class="c17">l</span><span class="c11">3,2 </span><span class="c17">l</span><span class="c11">3,3 </span><span class="c17">l</span><span class="c11">3,4 </span><span class="c17">L</span><span class="c11">4</span><span class="c21">: </span><span class="c17">l</span><span class="c11">4,1 </span><span class="c17">l</span><span class="c11">4,2 </span><span class="c17">l</span><span class="c11">4,3 </span><span class="c17">l</span><span class="c11">4,4 </span></p><p class="c25"><span class="c70">subgroup</span><span class="c63">1 </span></p><p class="c25"><span class="c70">subgroup</span><span class="c63">2 </span></p><p class="c25"><span class="c79">G</span><span class="c58">1,1,1 </span><span class="c79">G</span><span class="c58">1,1,2 </span><span class="c79">G</span><span class="c58">2,1,1 </span><span class="c79">G</span><span class="c58">2,1,2 </span><span class="c102">subgroup</span><span class="c57">1 </span></p><p class="c25"><span class="c102">subgroup</span><span class="c57">2 </span></p><p class="c25"><span class="c70">segment</span><span class="c63">2 </span></p><p class="c25"><span class="c4">(d) </span><span class="c3">Figure 3: Candidate query generation, where n = 4, d = 4, and &delta; = 8: (a) the partition parameters are &nbsp;&#772;n = (2, 2) and d </span><span class="c30">&nbsp;&#772;</span><span class="c3">= (2, 2); (b) G</span><span class="c18">2</span><span class="c35">,</span><span class="c18">1</span><span class="c35">,</span><span class="c18">1 </span><span class="c3">represents the set {l</span><span class="c18">1</span><span class="c35">,</span><span class="c18">3</span><span class="c3">,l</span><span class="c18">2</span><span class="c35">,</span><span class="c18">3</span><span class="c3">} for se&#1076;ment</span><span class="c18">2</span><span class="c3">, sub&#1076;roup</span><span class="c18">1</span><span class="c3">, and the first position in se&#1076;ment</span><span class="c18">2</span><span class="c3">, while G</span><span class="c18">2</span><span class="c35">,</span><span class="c18">1</span><span class="c35">,</span><span class="c18">: </span><span class="c3">= {G</span><span class="c18">2</span><span class="c35">,</span><span class="c18">1</span><span class="c35">,</span><span class="c18">1</span><span class="c3">,G</span><span class="c18">2</span><span class="c35">,</span><span class="c18">1</span><span class="c35">,</span><span class="c18">2</span><span class="c3">}; (c) candidate queries C</span><span class="c1">1 </span><span class="c7">&minus; C</span><span class="c1">4 </span><span class="c7">are generated for se&#1076;ment</span><span class="c1">1</span><span class="c7">, and candidate queries C</span><span class="c1">5 </span><span class="c7">&minus; C</span><span class="c1">8 </span><span class="c7">are generated for se&#1076;ment</span><span class="c1">2</span><span class="c7">; (d) the </span><span class="c3">candidate query list contains the real query (in red). </span></p><p class="c6"><span class="c3">&delta;</span><span class="c9">&prime; </span><span class="c3">in Eqn (</span><span class="c5">7</span><span class="c3">) is the total number of candidate queries generated above. Eqn (</span><span class="c5">9</span><span class="c3">) requires that the sum of all segment sizes should bed, and Eqn (</span><span class="c5">10</span><span class="c3">) requires that the parameters should be integers. The sizes of subgroups are not included in Eqn (</span><span class="c5">7</span><span class="c3">) because they are irrelevant. d,&delta;,n are constants and the rest are unknown variables. For the single user query, n = 1 and &delta; = d, we can choose &beta; = d with each segment size equal to 1. The above is a nonlinear integer programming problem, which is NP-hard [</span><span class="c22">4</span><span class="c3">]. However, the results for frequently used (n,d,&delta;) can be pre- computed off line (e.g., using open-source solvers [</span><span class="c22">6</span><span class="c3">], Bonmin</span><span class="c86">2</span><span class="c3">). This only needs to be done once. </span></p><p class="c50"><span class="c32">4.2 PPGNN Solution </span><span class="c3">The PPGNN solution has three stages: query generation, query processing, and answer decryption. Following [</span><span class="c22">14</span><span class="c3">], we assume that a coordinator user u</span><span class="c1">c </span><span class="c7">is selected randomly from the query </span><span class="c3">group to assist query generation and answer decryption. Like any other user, no additional trust is assumed of u</span><span class="c1">c</span><span class="c7">. </span><span class="c3">Query Generation. Algorithm ation stage. u</span><span class="c1">c </span><span class="c7">first determines the </span><span class="c5">1 </span><span class="c7">partition </span><span class="c3">presents </span><span class="c7">parameters </span><span class="c3">the query gener- </span><span class="c7">{ &#772;n, d} </span><span class="c3">&nbsp;&#772;based on {n,d,&delta;} and calculates the number of candidate queries &delta;</span><span class="c9">&prime;</span><span class="c3">. As discussed above, the partition parameters could be pre- computed for frequently used {n,d,&delta;}. u</span><span class="c1">c </span><span class="c7">randomly selects a </span><span class="c3">segment seg from [1, &beta;] according to the probability distribution based on the segment sizes, i.e., </span></p><p class="c25"><span class="c3">P = ( d</span><span class="c7">d </span><span class="c30">&nbsp;&#772;</span><span class="c1">1</span><span class="c3">, &middot;&middot;&middot; , </span></p><p class="c25"><span class="c3">Algorithm 1: Query Generation </span></p><p class="c25"><span class="c4">Input: n, d, Output: Query &delta;, k, keysize, {k</span><span class="c16">, </span><span class="c4">pk</span><span class="c16">, </span><span class="c4">&nbsp;&#772;n</span><span class="c16">, </span><span class="c4">{ld</span><span class="c16">, </span><span class="c20">&nbsp;&#772;</span><span class="c13">i</span><span class="c60">,</span><span class="c13">&lowast;</span><span class="c37">}</span><span class="c4">[</span><span class="c16">v</span><span class="c4">]</span><span class="c16">, </span><span class="c65">n</span><span class="c13">i=1</span><span class="c4">&theta;, &theta;</span><span class="c13">0</span><span class="c37">; </span></p><p class="c25"><span class="c13">0</span><span class="c16">, </span><span class="c4">{(i</span><span class="c16">, </span><span class="c4">L</span><span class="c13">i</span><span class="c4">)}</span><span class="c65">i=1</span><span class="c23">n</span><span class="c20">}; </span><span class="c36">1 2 </span><span class="c4">Coordinator { &#772;n</span><span class="c16">, </span><span class="c4">d </span><span class="c20">&nbsp;&#772;</span><span class="c4">} u</span><span class="c13">c</span><span class="c4">: </span></p><p class="c25"><span class="c4">&larr; find the partition parameters; // Eqn (</span><span class="c52">7</span><span class="c4">)-(</span><span class="c52">10</span><span class="c4">); </span><span class="c36">3 </span><span class="c4">seg &larr; randomly select a segment by Eqn (</span><span class="c52">11</span><span class="c4">); </span><span class="c36">4 </span><span class="c4">for j &isin; [1</span><span class="c16">, </span><span class="c4">| &#772;n|] do </span><span class="c36">5 </span><span class="c4">x</span><span class="c13">j </span><span class="c37">&larr; randomly and uniformly select from [1</span><span class="c69">, </span><span class="c37">d</span><span class="c4">&nbsp;&#772;</span><span class="c13">seg</span><span class="c37">]; </span><span class="c36">6 </span><span class="c4">pos</span><span class="c13">j </span><span class="c4">&larr; </span><span class="c23">seg&minus;1 </span></p><p class="c25"><span class="c65">i=1 </span><span class="c4">d</span><span class="c20">&nbsp;&#772;</span><span class="c13">i </span><span class="c37">+ x</span><span class="c13">j</span><span class="c37">; </span><span class="c36">7 </span><span class="c4">Send pos</span><span class="c13">j </span><span class="c4">to all users in subgroup</span><span class="c13">j</span><span class="c4">; </span><span class="c36">8 </span><span class="c4">{sk</span><span class="c16">, </span><span class="c4">pk } &larr; Gen(keysize); // key generation </span><span class="c36">9 </span><span class="c16">v </span><span class="c4">&larr; construct indicator vector by the query index; // Eqn (</span><span class="c52">12</span><span class="c4">) </span><span class="c36">10 </span><span class="c4">[</span><span class="c16">v</span><span class="c4">] &larr; element-wise encryption Enc(</span><span class="c16">v</span><span class="c4">, pk); </span><span class="c36">11 </span><span class="c4">Send {k</span><span class="c16">, </span><span class="c4">pk</span><span class="c16">, </span><span class="c4">&nbsp;&#772;n</span><span class="c16">, </span><span class="c4">d</span><span class="c16">, </span><span class="c20">&nbsp;&#772;</span><span class="c4">[</span><span class="c16">v</span><span class="c4">]</span><span class="c16">, </span><span class="c4">&theta;</span><span class="c13">0</span><span class="c37">} to LSP; </span></p><p class="c25"><span class="c36">12 </span><span class="c4">Every user u</span><span class="c13">i </span><span class="c37">in subgroup</span><span class="c13">j</span><span class="c4">: </span><span class="c36">13 </span><span class="c4">receive pos</span><span class="c13">j </span><span class="c4">from u</span><span class="c13">c</span><span class="c4">; </span><span class="c36">14 </span><span class="c4">L</span><span class="c13">i </span><span class="c37">&larr; generate location set, arranging l</span><span class="c13">i</span><span class="c60">,</span><span class="c13">&lowast; </span><span class="c37">on the pos</span><span class="c13">j</span><span class="c4">-th position; </span><span class="c36">15 </span><span class="c4">Send (i</span><span class="c16">, </span><span class="c4">L</span><span class="c13">i</span><span class="c4">) to LSP; </span></p><p class="c25"><span class="c3">Algorithm 2: Query Processing </span><span class="c36">1 2 </span><span class="c4">Input: Query {k</span><span class="c16">, </span><span class="c4">pk</span><span class="c16">, </span><span class="c4">&nbsp;&#772;n</span><span class="c16">, </span><span class="c4">d</span><span class="c16">, </span><span class="c20">&nbsp;&#772;</span><span class="c4">[</span><span class="c16">v</span><span class="c4">]</span><span class="c16">, </span><span class="c4">Output: {C</span><span class="c13">t </span><span class="c4">{ &#772;n</span><span class="c16">, </span><span class="c4">}</span><span class="c65">t=1 </span><span class="c105">&delta;</span><span class="c4">d</span><span class="c16">, </span><span class="c20">&nbsp;&#772;</span><span class="c95">&prime; </span><span class="c4">for t &isin; [a</span><span class="c13">&lowast;</span><span class="c37">]; </span></p><p class="c25"><span class="c20">&larr; generate </span><span class="c4">{(i</span><span class="c16">, </span><span class="c4">[1</span><span class="c16">, </span><span class="c4">&delta;L</span><span class="c23">&prime;</span><span class="c4">] </span><span class="c13">i</span><span class="c37">)}</span><span class="c4">do </span></p><p class="c25"><span class="c13">i=1</span><span class="c65">n</span><span class="c4">&theta;</span><span class="c13">0</span><span class="c16">, </span><span class="c4">{(i</span><span class="c16">, </span><span class="c4">L</span><span class="c13">i</span><span class="c4">)}</span><span class="c65">i=1</span><span class="c23">n</span><span class="c20">}</span><span class="c146">, </span><span class="c20">D; the candidate query list by </span><span class="c4">}}; // Section </span><span class="c52">4.1 </span></p><p class="c25"><span class="c36">3 </span><span class="c4">P</span><span class="c13">t </span><span class="c37">&larr; compute kGNN query by (k, C</span><span class="c13">t </span><span class="c37">, D); </span><span class="c36">4 5 </span><span class="c4">P</span><span class="c23">&prime;</span><span class="c65">t </span><span class="c4">a</span><span class="c13">t </span><span class="c20">&larr; answerSanitation(&theta;</span><span class="c4">&larr; encode P</span><span class="c23">&prime;</span><span class="c65">t 0</span><span class="c16">, </span><span class="c4">P</span><span class="c13">t</span><span class="c69">, </span><span class="c37">C</span><span class="c13">t </span><span class="c37">); // Section </span><span class="c83">5.2 </span></p><p class="c25"><span class="c20">into integer vector by N stated in pk; </span></p><p class="c25"><span class="c36">6 </span><span class="c4">A = (a</span><span class="c13">1</span><span class="c16">, </span><span class="c4">&middot;&middot;&middot; </span><span class="c16">, </span><span class="c4">a</span><span class="c60">&delta; </span><span class="c36">&prime;</span><span class="c4">); </span><span class="c36">7 </span><span class="c4">[a</span><span class="c13">&lowast;</span><span class="c37">] = A [</span><span class="c69">v</span><span class="c37">]; // Theorem </span><span class="c83">3.1 </span><span class="c36">8 </span><span class="c4">Send [a</span><span class="c13">&lowast;</span><span class="c37">] to u</span><span class="c13">c </span></p><p class="c25"><span class="c3">length Then, &delta;</span><span class="c9">&prime;</span><span class="c3">, uwhere </span><span class="c1">c </span><span class="c3">else. Finally, </span><span class="c7">constructs the encrypted indicator vector [</span><span class="c66">v</span><span class="c7">] of </span><span class="c3">u</span><span class="c18">c </span><span class="c7">d</span><span class="c3">&nbsp;&#772;</span><span class="c7">d </span><span class="c1">&beta;</span><span class="c3">) (11) and u</span><span class="c1">c </span><span class="c7">randomly and uniformly selects a relative position x</span><span class="c1">j </span><span class="c3">of that segment for the j-th subgroup, and broadcasts pos</span><span class="c18">j </span><span class="c3">to all users in the j-th subgroup, 1 &le; j &le; &alpha;, where pos</span><span class="c1">j </span><span class="c7">is the </span><span class="c3">absolute position (over all segments) corresponding to x</span><span class="c1">j</span><span class="c7">. Then </span><span class="c3">u</span><span class="c18">c </span><span class="c3">computes the position of the real query C</span><span class="c18">&lowast; </span><span class="c3">in the candidate query that the list, candidate called query query index, list denoted is arranged by QIby </span><span class="c1">C</span><span class="c61">&lowast; </span><span class="c3">the as lexicographic follows. Note </span></p><p class="c25"><span class="c3">order of the triples (segment index, subgroup index, position in the segment). </span></p><p class="c25"><span class="c3">QI</span><span class="c1">C</span><span class="c61">&lowast; </span><span class="c3">= </span><span class="c9">seg&minus;1 </span></p><p class="c25"><span class="c18">i=1 </span><span class="c30">( </span><span class="c3">d</span><span class="c18">i</span><span class="c3">)</span><span class="c30">&nbsp;&#772;</span><span class="c9">&alpha; </span><span class="c3">+ </span><span class="c9">&alpha;</span><span class="c18">j=1</span><span class="c30">(x</span><span class="c9">j </span><span class="c30">&minus; 1)( </span><span class="c3">d</span><span class="c18">seg</span><span class="c3">)</span><span class="c30">&nbsp;&#772;</span><span class="c9">&alpha;&minus;j </span><span class="c3">+ 1 (12) </span></p><p class="c25"><span class="c14">v </span><span class="c3">sends has the 1 at query the position {k,pk, &nbsp;&#772;n, QId,[</span><span class="c14">v</span><span class="c3">],&theta;</span><span class="c18">0</span><span class="c3">} </span><span class="c30">&nbsp;&#772;</span><span class="c1">C</span><span class="c61">&lowast; </span><span class="c3">and 0 everywhere </span></p><p class="c25"><span class="c3">to LSP. where the first term is the number of candidate queries before </span></p><p class="c25"><span class="c3">Meanwhile, every user u</span><span class="c1">i</span><span class="c7">(i &isin; [1,n]) in the j-th subgroup </span><span class="c3">reaching the seg-th segment, and the second term is the number </span></p><p class="c25"><span class="c3">arranges its real location l</span><span class="c1">i</span><span class="c48">,</span><span class="c1">&lowast; </span><span class="c7">at the received position pos</span><span class="c1">j </span><span class="c7">in L</span><span class="c1">i </span><span class="c3">of candidate queries before reaching C</span><span class="c1">&lowast; </span><span class="c7">in the seg-th segment. </span></p><p class="c25"><span class="c3">Example 4.2. In Figure </span><span class="c5">4a</span><span class="c3">, with seg = 2, &alpha; = 2, and d</span><span class="c30">&nbsp;&#772;</span><span class="c1">1 </span><span class="c7">= 2, the </span><span class="c3">first term term is (2 in &minus; 1) Eqn &lowast; 2(</span><span class="c5">12</span><span class="c3">) </span><span class="c9">1 </span><span class="c3">+ is (1 4, &minus; and 1) &lowast; with 2</span><span class="c9">0 </span><span class="c3">= x2, </span><span class="c1">1 </span><span class="c7">= 2 and x</span><span class="c1">2 </span><span class="c7">= 1, the second </span></p><p class="c25"><span class="c3">thus QI</span><span class="c1">C</span><span class="c61">&lowast; </span><span class="c3">= 7. D </span></p><p class="c50"><span class="c3">and dummy locations at the remaining positions, and sends (i, L</span><span class="c18">i</span><span class="c3">) to LSP independently. With the user ID i, LSP can reconstruct sub&#1076;roup</span><span class="c1">1 </span><span class="c7">as the first &nbsp;&#772;n</span><span class="c1">1 </span><span class="c7">users, sub&#1076;roup</span><span class="c1">2 </span><span class="c7">as the next &nbsp;&#772;n</span><span class="c1">2 </span><span class="c7">users, </span><span class="c3">and so on. Note that no user, including u</span><span class="c18">c</span><span class="c3">, knows other users&rsquo; real locations, because each user sends the location set to LSP </span><span class="c36">2</span><span class="c12">https://neos-server.org/neos/solvers/ </span></p><p class="c25"><span class="c3">directly. </span></p><p class="c25"><span class="c88">281 </span></p><p class="c6"><span class="c3">Query Processing. Algorithm </span><span class="c5">2 </span><span class="c3">presents the query process- ing stage. After receiving the query from users, LSP generates the candidate query list containing &delta;</span><span class="c9">&prime; </span><span class="c3">candidate queries as described in Section </span><span class="c5">4.1</span><span class="c3">, and executes the kGNN query for each candidate query. Line 4 calls the answerSanitation method to ensure that the query answer satisfies Privacy IV, which will be presented in Section </span><span class="c5">5.2</span><span class="c3">. Let A</span><span class="c9">m&times;&delta;</span><span class="c95">&prime; </span><span class="c3">be the answer matrix for the query answers (a</span><span class="c1">1</span><span class="c7">, &middot;&middot;&middot; ,a</span><span class="c1">&delta; </span><span class="c36">&prime;</span><span class="c3">). LSP privately selects the query answer [a</span><span class="c1">&lowast;</span><span class="c7">] for C</span><span class="c1">&lowast; </span><span class="c7">following Theorem </span><span class="c84">3.1</span><span class="c7">, and sends [a</span><span class="c1">&lowast;</span><span class="c7">] to u</span><span class="c1">c</span><span class="c7">. </span></p><p class="c25"><span class="c3">The answer decryption stage is the same as that in Section </span><span class="c5">3</span><span class="c3">, except that u</span><span class="c1">c </span><span class="c7">will broadcast the answer a</span><span class="c1">&lowast; </span><span class="c7">to all other users. </span></p><p class="c25"><span class="c32">4.3 Privacy Guarantees </span></p><p class="c25"><span class="c3">Theorem 4.3. The PPGNN solution satisfies Privacy I-III. . </span></p><p class="c6"><span class="c3">Proof. Privacy I: The segment se&#1076; containing the real loca- tions is selected following the probability distribution correspond- ing to the segment sizes, Eqn (</span><span class="c5">11</span><span class="c3">), thus, the probability that LSP infers this segment is </span><span class="c30">&nbsp;&#772;</span><span class="c3">d</span><span class="c1">se&#1076;</span><span class="c7">/d. The position for the real locations </span><span class="c3">in the se&#1076;-th segment for each subgroup is selected randomly and uniformly, so given the segmentse&#1076;, the probability that LSP can infer this position is 1/ </span><span class="c30">&nbsp;&#772;</span><span class="c3">d</span><span class="c1">se&#1076;</span><span class="c7">. Overall, the probability for LSP </span><span class="c3">to identify each user&rsquo;s real location is ( </span><span class="c30">&nbsp;&#772;</span><span class="c3">d</span><span class="c18">i</span><span class="c3">/d)&middot;(1/ </span><span class="c30">&nbsp;&#772;</span><span class="c3">d</span><span class="c18">i</span><span class="c3">) = 1/d. </span></p><p class="c6"><span class="c3">Privacy II: LSP generates &delta;</span><span class="c9">&prime;</span><span class="c3">(&ge; &delta;) candidate queries and ob- tain &delta;</span><span class="c9">&prime; </span><span class="c3">query answers before the private selection. So the proba- bility for LSP to identify group&rsquo;s query C</span><span class="c18">&lowast; </span><span class="c3">and the query answer is 1/&delta;</span><span class="c9">&prime;</span><span class="c3">, which is no larger than 1/&delta;. </span></p><p class="c6"><span class="c3">Privacy III: The private selection ensures that only the answer for C</span><span class="c18">&lowast; </span><span class="c3">is returned, so the users learn no extra POI information beyond the query answer requested. D </span></p><p class="c25"><span class="c32">5 FULL USER COLLUSION </span><span class="c3">So far, the PPGNN solution satisfies only Privacy I-III. We now consider answerSanitation on line 4 in Algorithm </span><span class="c5">2 </span><span class="c3">to enforce Privacy IV under the full user collusion assumption. Our first observation is that the only communication within the user group is {pos</span><span class="c1">j</span><span class="c7">}</span><span class="c18">&alpha;</span><span class="c1">j=1 </span><span class="c3">that are broadcast from u</span><span class="c1">c </span><span class="c7">to let all users arrange </span><span class="c3">their real locations in their location sets. This information alone does not allow anyn &minus;1 colluding users to learn the real location of the remaining user. However, after receiving the query answer, n &minus;1 colluding users can infer some possible region that contains the remaining user&rsquo;s real location, with the help of the ranking and location information of the POIs in the query answer. We first present this attack in Section </span><span class="c5">5.1</span><span class="c3">, and devise a method to prevent this attack and satisfy Privacy IV in the rest of the section. </span></p><p class="c25"><span class="c32">5.1 Inequality Attack </span><span class="c3">Suppose the users {u</span><span class="c18">1</span><span class="c3">, &middot;&middot;&middot; ,u</span><span class="c18">n</span><span class="c3">} located at the locations C</span><span class="c18">&lowast; </span><span class="c3">= {l</span><span class="c1">1</span><span class="c48">,</span><span class="c1">&lowast;</span><span class="c7">, &middot;&middot;&middot; ,l</span><span class="c1">n</span><span class="c48">,</span><span class="c1">&lowast;</span><span class="c7">} respectively obtain the query answer in the form </span><span class="c3">of k ranked POIs P = {p</span><span class="c1">1</span><span class="c7">, &middot;&middot;&middot; ,p</span><span class="c1">k</span><span class="c3">} such that </span></p><p class="c50"><span class="c3">F(p</span><span class="c1">i</span><span class="c7">, C</span><span class="c1">&lowast;</span><span class="c7">) &le; F(p</span><span class="c1">j</span><span class="c7">,C</span><span class="c1">&lowast;</span><span class="c7">), &forall;1 &le; i &lt; j &le; k (13) </span><span class="c3">Without loss of generality, let us assume that u</span><span class="c1">1 </span><span class="c7">is the attack </span><span class="c3">target and {u</span><span class="c18">i</span><span class="c3">}</span><span class="c9">n</span><span class="c18">i=2 </span><span class="c30">collude together to infer u</span><span class="c9">1</span><span class="c30">&rsquo;s location. There- </span><span class="c3">fore, there is only one unknown variable l</span><span class="c1">1</span><span class="c48">,</span><span class="c1">&lowast; </span><span class="c7">in Eqn (</span><span class="c84">13</span><span class="c7">) because </span><span class="c3">l</span><span class="c1">2</span><span class="c48">,</span><span class="c1">&lowast;</span><span class="c7">, &middot;&middot;&middot; ,l</span><span class="c1">n</span><span class="c48">,</span><span class="c1">&lowast; </span><span class="c7">as well as the query answer P are known to the </span><span class="c3">colluding users. Consequently, the colluding users can construct k &minus; 1 independent inequalities to infer the possible region of l</span><span class="c1">1</span><span class="c48">,</span><span class="c1">&lowast;</span><span class="c7">: </span><span class="c3">F(p</span><span class="c18">i</span><span class="c3">, C</span><span class="c18">&lowast;</span><span class="c3">) &le; F(p</span><span class="c18">i+1</span><span class="c3">, C</span><span class="c18">&lowast;</span><span class="c3">), &forall;1 &le; i &le; k &minus; 1 (14) We refer this inference as the inequality attack. Suppose that the area of the solution region for Eqn (</span><span class="c5">14</span><span class="c3">) is &theta; (in percentage) of </span></p><p class="c6"><span class="c3">the area of the whole data space, Privacy IV is satisfied if and only if &theta; &gt; &theta;</span><span class="c1">0 </span><span class="c7">for every target user u</span><span class="c1">1</span><span class="c7">; otherwise, i.e., &theta; &le; &theta;</span><span class="c1">0 </span><span class="c3">for some target user u</span><span class="c18">1</span><span class="c3">, Privacy IV is not satisfied, and we say the inequality attack succeeds. For instance, Privacy IV is not satisfied in Figure </span><span class="c5">1 </span><span class="c3">if &theta;</span><span class="c1">0 </span><span class="c7">= 0.5, because the possible region for </span><span class="c3">u</span><span class="c18">1</span><span class="c3">&rsquo;s location (in shaded) is less than half of the whole location space. </span></p><p class="c25"><span class="c32">5.2 Answer Sanitation </span><span class="c3">One solution to prevent the inequality attack is that LSP randomly perturbs the order of POIs in P such that the inequalities in Eqn (</span><span class="c5">14</span><span class="c3">) cannot be correctly constructed. This solution will degrade the utility of the query answer because the users need to know the rank of returned locations. In addition, it is unclear how to ensure that the colluding users cannot reconstruct the original order or a partial order. </span></p><p class="c50"><span class="c3">Instead, we design a sanitation method for LSP to return the longest prefix P</span><span class="c9">&prime; </span><span class="c3">= {p</span><span class="c18">1</span><span class="c3">, &middot;&middot;&middot; ,p</span><span class="c18">t</span><span class="c3">} of P while satisfying Privacy IV. In fact, LSP can simulate the inequality attack for every user using a prefix P</span><span class="c9">&prime; </span><span class="c3">of P in Eqn (</span><span class="c5">14</span><span class="c3">). If &theta; &gt; &theta;</span><span class="c1">0 </span><span class="c7">holds on P</span><span class="c18">&prime; </span><span class="c7">for every </span><span class="c3">target user, where &theta; is the relative size of the solution region of Eqn (</span><span class="c5">14</span><span class="c3">), P</span><span class="c9">&prime; </span><span class="c3">is safe of satisfying Privacy IV. We will consider how to test &theta; P</span><span class="c9">&prime; </span><span class="c3">= {p</span><span class="c18">1</span><span class="c3">}, which &gt; &theta;</span><span class="c1">0 </span><span class="c7">shortly. LSP can start with the shortest prefix </span><span class="c3">is always safe, and examine the length t prefix only if the length t &minus; 1 prefix is safe. The query answer for a candidate query then is the prefix P</span><span class="c9">&prime; </span><span class="c3">= {p</span><span class="c1">1</span><span class="c7">, &middot;&middot;&middot; ,p</span><span class="c1">t</span><span class="c7">} that is safe, </span><span class="c3">and if t &lt; k, the next prefix {p</span><span class="c18">1</span><span class="c3">,&middot;&middot;&middot; ,p</span><span class="c18">t+1</span><span class="c3">} is not safe. Note that if the query answer for every candidate query is safe of satisfying Privacy IV, the returned answer for C</span><span class="c1">&lowast; </span><span class="c7">after private selection </span><span class="c3">satisfies Privacy IV. </span></p><p class="c25"><span class="c32">5.3 Testing &theta; &gt; &theta;</span><span class="c37">0 </span><span class="c3">We now present how to test whether &theta; &gt; &theta;</span><span class="c1">0 </span><span class="c7">for a target user, </span><span class="c3">where &theta; is the relative size of the solution region of Eqn (</span><span class="c5">14</span><span class="c3">). One approach is finding the exact solution region of Eqn (</span><span class="c5">14</span><span class="c3">). Unfortunately, finding this solution region is not straightforward, especially for any choice of the aggregation function F and an arbitrary shape of the data space. On the other hand, it is easy to test whether a point l</span><span class="c1">1</span><span class="c48">,</span><span class="c1">&lowast; </span><span class="c7">satisfies all inequalities in Eqn (</span><span class="c84">14</span><span class="c7">), </span><span class="c3">that is, falls into the solution region, without explicitly finding the solution region. This observation motivates the following statistic test. </span></p><p class="c25"><span class="c3">Consider two hypothesis H</span><span class="c18">0 </span><span class="c3">and H</span><span class="c18">1</span><span class="c3">: </span></p><p class="c25"><span class="c3">H</span><span class="c18">0 </span><span class="c3">: &theta; &le; &theta;</span><span class="c18">0</span><span class="c3">, H</span><span class="c18">1 </span><span class="c3">: &theta; &gt; &theta;</span><span class="c18">0 </span><span class="c3">(15) </span></p><p class="c25"><span class="c3">There are two types of errors: </span></p><p class="c25"><span class="c3">&bull; Type I Error: Pr(reject H</span><span class="c18">0</span><span class="c3">|H</span><span class="c18">0 </span><span class="c3">is true) is the probability that a successful attack is not identified for a target user. </span></p><p class="c25"><span class="c3">&bull; Type II Error: Pr(not reject H</span><span class="c1">0</span><span class="c7">|H</span><span class="c1">1 </span><span class="c7">is true) is the proba- </span><span class="c3">bility that a non-attack is identified as a successful attack for a target user. A small probability for Type I Error provides more confidence on privacy protection and a small probability for Type II Error provides more confidence on better utility of the returned answer. We want to bound these probabilities. </span></p><p class="c50"><span class="c3">To test whether H</span><span class="c1">0 </span><span class="c7">should be rejected, LSP can uniformly and </span><span class="c3">independently space. The outcome sample of each N</span><span class="c1">H </span><span class="c3">sample points is Xa </span><span class="c1">1</span><span class="c7">, </span><span class="c3">Bernoulli </span><span class="c7">&middot;&middot;&middot; ,X</span><span class="c1">N</span><span class="c61">H </span><span class="c3">random from the variable data </span></p><p class="c25"><span class="c3">B = </span></p><p class="c25"><span class="c3">{ </span><span class="c7">1, if X</span><span class="c1">i </span><span class="c7">satisfies the inequalities in Eqn (</span><span class="c84">14</span><span class="c7">) </span></p><p class="c25"><span class="c3">0, otherwise </span></p><p class="c25"><span class="c88">282 </span></p><p class="c50"><span class="c3">The probability of B = 1 is equal to the relative size &theta; of the solution distribution. region For of a Eqn large (</span><span class="c5">14</span><span class="c3">).X N</span><span class="c1">H</span><span class="c7">, </span><span class="c3">= </span><span class="c7">this </span><span class="c3">X</span><span class="c1">1</span><span class="c7">+&middot;&middot;&middot;+XBinomial </span><span class="c1">N</span><span class="c61">H </span><span class="c7">distribution </span><span class="c3">follows a Binomial </span><span class="c7">can be </span><span class="c3">approximated by the normal distribution. In this case, LSP can reject H</span><span class="c1">0 </span><span class="c7">through the Z-test statistic [</span><span class="c117">7</span><span class="c7">]: reject H</span><span class="c1">0 </span><span class="c7">if </span></p><p class="c25"><span class="c3">X &gt; N</span><span class="c1">H</span><span class="c3">&theta;</span><span class="c1">0 </span><span class="c7">+ z</span><span class="c1">&gamma; </span></p><p class="c6"><span class="c3">&radic;</span><span class="c7">N</span><span class="c1">H</span><span class="c3">&theta;</span><span class="c1">0</span><span class="c7">(1 &minus;&theta;</span><span class="c1">0</span><span class="c7">) (16) </span><span class="c3">where z</span><span class="c1">&gamma; </span><span class="c7">is the critical value of the normal distribution and &gamma; </span><span class="c3">is a desired upper bound for the Type I Error probability, i.e., Pr(reject H</span><span class="c1">0</span><span class="c7">|H</span><span class="c1">0 </span><span class="c7">is true) &le; &gamma;. </span></p><p class="c6"><span class="c3">To test if&theta; &gt; &theta;</span><span class="c1">0 </span><span class="c7">in the answer sanitation, LSP tests the inequal- </span><span class="c3">ity in Eqn (</span><span class="c5">16</span><span class="c3">) instead. From the above discussion, the probability of capturing a successful attack, i.e., Pr(not reject H</span><span class="c1">0</span><span class="c7">|H</span><span class="c1">0 </span><span class="c7">is true), </span><span class="c3">is at least 1 &minus; &gamma;. Since this approach only requires testing if a point satisfies the inequalities in Eqn (</span><span class="c5">14</span><span class="c3">) (for computing X), it is applicable to any choice of the aggregation function F and any shape of the data space. </span></p><p class="c50"><span class="c3">To determine the sample size N</span><span class="c1">H</span><span class="c7">, we need to take the probabil- </span><span class="c3">ity of Type II Error, i.e., Pr(not reject H</span><span class="c1">0</span><span class="c7">|H</span><span class="c1">1 </span><span class="c7">is true), into consid- </span><span class="c3">eration. to significantly where &phi; Let &theta;</span><span class="c18">1 </span><span class="c3">denote the minimum &theta; value differentiate from &theta;</span><span class="c1">0</span><span class="c7">. [</span><span class="c117">15</span><span class="c7">] </span><span class="c3">is the ratio difference between &theta;</span><span class="c1">1 </span><span class="c7">suggests and </span><span class="c3">in </span><span class="c7">&theta;</span><span class="c3">H</span><span class="c18">1 </span><span class="c1">0</span><span class="c7">. The </span><span class="c3">that </span><span class="c18">&theta;</span><span class="c1">&theta;</span><span class="c61">10 </span><span class="c3">we want = (1 + &phi;), </span><span class="c7">two types </span><span class="c3">of errors can be bounded given enough samples, as stated below. </span></p><p class="c6"><span class="c3">Theorem 5.1 (Sample Size [</span><span class="c22">11</span><span class="c3">]). In the one-tailed hypothesis testing, the sample size N</span><span class="c1">H </span><span class="c7">required for Pr(Type I Error) &le; &gamma; and </span><span class="c3">Pr(Type II Error) &le; &eta; is given by </span></p><p class="c25"><span class="c3">N</span><span class="c1">H </span><span class="c3">&ge; </span></p><p class="c42"><span class="c3">[</span><span class="c7">z</span><span class="c1">&gamma; </span><span class="c3">&radic;</span><span class="c7">&theta;</span><span class="c1">0</span><span class="c7">(1 &minus; &theta;</span><span class="c1">0</span><span class="c7">) + z</span><span class="c1">&eta;</span><span class="c3">&radic;</span><span class="c7">&theta;</span><span class="c1">1</span><span class="c7">(1 &minus;&theta;</span><span class="c1">1</span><span class="c7">) </span><span class="c3">&theta;</span><span class="c18">1 </span><span class="c3">&minus; &theta;</span><span class="c18">0 </span></p><p class="c25"><span class="c3">]</span><span class="c1">2</span><span class="c7">.D (17) </span></p><p class="c25"><span class="c3">The commonly used&gamma;,&eta;,&phi; are &gamma; = 0.05, &eta; = 0.2, and &phi; = 0.1. Once the users specify &theta;</span><span class="c18">0</span><span class="c3">, LSP can determine the sample size N</span><span class="c1">H </span><span class="c7">using Eqn (</span><span class="c84">17</span><span class="c7">). </span></p><p class="c25"><span class="c32">5.4 Privacy Guarantees </span></p><p class="c25"><span class="c3">Theorem 5.2. The PPGNN solution with the answer sanitation satisfies Privacy I-IV under the full user collusion assumption. </span></p><p class="c6"><span class="c3">Proof. Privacy I-III follows from Theorem </span><span class="c5">4.3</span><span class="c3">. Suppose the returned query answer for C</span><span class="c18">&lowast; </span><span class="c3">is P</span><span class="c18">&lowast;</span><span class="c3">, which passes the answer sanitation. Therefore, for every target useru</span><span class="c1">i </span><span class="c7">in the group query, </span><span class="c3">the Type I Error probability, Pr(reject H</span><span class="c1">0</span><span class="c7">|H</span><span class="c1">0 </span><span class="c7">is true), is bounded </span><span class="c3">by &gamma;. In other words, u</span><span class="c18">i</span><span class="c3">&rsquo;s real location is guaranteed to hide in a region that is at least &theta;</span><span class="c1">0 </span><span class="c7">(in percentage) of the whole space with </span><span class="c3">the confidence 1 &minus;&gamma;, i.e., Privacy IV is satisfied. </span></p><p class="c6"><span class="c3">A noteworthy point is that the answer sanitation does not affect the protection for Privacy I-III because it only reduces the number of POIs in the query answer returned to the users (by returning a prefix of the original top-k answer). The users learn from the reduced list of POIs that the remaining POIs in the answer are not returned because there is an inequality at- tack. However, without these remaining POIs, the users cannot perform such attacks. D </span></p><p class="c25"><span class="c32">6 OPTIMIZED PPGNN </span><span class="c3">The indicator vector</span><span class="c14">v </span><span class="c3">with length&delta;</span><span class="c9">&prime; </span><span class="c3">has only a single 1 (specify- ing C</span><span class="c1">&lowast;</span><span class="c7">) and(&delta;</span><span class="c18">&prime;</span><span class="c7">&minus;1)0&rsquo;s. If&delta;</span><span class="c18">&prime; </span><span class="c7">is large, additional user computational </span><span class="c3">cost and communication cost are spent on encrypting and trans- mitting many 0&rsquo;s. In this section, we present an optimization of PPGNN solution, called PPGNN-OPT, to reduce these costs. Let &#10214;&middot;&#10215; denote the ciphertext generated by the generalized Paillier cryptosystem &epsilon;</span><span class="c18">s </span><span class="c3">with s = 2 (see Section </span><span class="c5">3.1</span><span class="c3">), and as before, let [&middot;] </span></p><p class="c25"><span class="c17">A</span><span class="c11">1 </span><span class="c17">A</span><span class="c11">2 </span></p><p class="c25"><span class="c17">[a</span><span class="c11">3</span><span class="c17">] </span><span class="c17">[a</span><span class="c11">7</span><span class="c17">] </span></p><p class="c25"><span class="c71">0</span><span class="c26">00000</span><span class="c26">10 </span></p><p class="c25"><span class="c71">0</span><span class="c26">0</span><span class="c26">10</span><span class="c26">0</span><span class="c26">1 </span></p><p class="c25"><span class="c17">a</span><span class="c11">1 </span><span class="c17">a</span><span class="c11">2 </span><span class="c17">a</span><span class="c11">3 </span><span class="c17">a</span><span class="c11">4 </span><span class="c17">a</span><span class="c11">5 </span><span class="c17">a</span><span class="c11">6 </span><span class="c17">a</span><span class="c11">7 </span><span class="c17">a</span><span class="c11">8 </span></p><p class="c25"><span class="c74">v</span><span class="c113">1</span><span class="c40">v</span><span class="c113">2 </span></p><p class="c25"><span class="c4">(a) </span></p><p class="c25"><span class="c17">[v</span><span class="c11">1</span><span class="c17">] [v</span><span class="c11">1</span><span class="c17">] </span></p><p class="c25"><span class="c101">v</span><span class="c123">2 </span></p><p class="c25"><span class="c17">[a</span><span class="c11">7</span><span class="c17">]</span><span class="c4">(b) </span></p><p class="c25"><span class="c3">Figure 4: Optimization example: (a) changes on the user side; (b) two phases private selection on the LSP side </span></p><p class="c6"><span class="c3">denote the ciphertext generated by &epsilon;</span><span class="c1">s </span><span class="c7">with s = 1. The encryption </span><span class="c3">and decryption with &epsilon;</span><span class="c18">2 </span><span class="c3">can use the same public key and secret key as those with &epsilon;</span><span class="c1">1 </span><span class="c7">[</span><span class="c117">10</span><span class="c7">]. </span></p><p class="c50"><span class="c3">To explain our optimization, Figure </span><span class="c5">4 </span><span class="c3">illustrates the changes made on the user side and the LSP side for the example in Figure </span><span class="c5">3 </span><span class="c3">where &delta;</span><span class="c9">&prime; </span><span class="c3">= &delta; = 8. Instead of using the original indicator vector </span><span class="c14">v </span><span class="c3">= (0,0,0, 0, 0, 0,1,0)</span><span class="c9">T </span><span class="c3">to indicate the position of the real query, u</span><span class="c1">c </span><span class="c7">uses two small vectors</span><span class="c66">v</span><span class="c1">1 </span><span class="c7">= (0, 0,1, 0)</span><span class="c18">T </span><span class="c7">and </span><span class="c66">v</span><span class="c1">2 </span><span class="c7">= (0, 1)</span><span class="c18">T </span><span class="c7">. On </span><span class="c3">the user side,u</span><span class="c18">c </span><span class="c3">executes element-wise encryption on</span><span class="c14">v</span><span class="c18">1 </span><span class="c3">with &epsilon;</span><span class="c18">1 </span><span class="c3">and executes [</span><span class="c14">v</span><span class="c18">1</span><span class="c3">] = element-wise encryption ([0], [0],[1], [0])</span><span class="c9">T </span><span class="c3">, &#10214;</span><span class="c14">v</span><span class="c18">2</span><span class="c3">&#10215; = (&#10214;0&#10215;, &#10214;1&#10215;)on </span><span class="c14">v</span><span class="c9">T </span><span class="c1">2 </span><span class="c3">. </span><span class="c7">with &epsilon;</span><span class="c1">2</span><span class="c7">, obtaining </span><span class="c3">These vectors are sent to LSP. In this case, the user computational cost and the communication cost are that for computing and transmitting [</span><span class="c14">v</span><span class="c18">1</span><span class="c3">] and &#10214;</span><span class="c14">v</span><span class="c18">2</span><span class="c3">&#10215;, instead of that for [</span><span class="c14">v</span><span class="c3">]. </span></p><p class="c6"><span class="c3">On the LSP side, after obtaining the answer matrix A, LSP privately selects the desired answer in two phases. Firstly, LSP partitions A into two sub-matrices (A</span><span class="c18">1</span><span class="c3">,A</span><span class="c18">2</span><span class="c3">). For each sub-matrix, LSP executes a private selection using [</span><span class="c14">v</span><span class="c1">1</span><span class="c7">] (Theorem </span><span class="c84">3.1</span><span class="c7">), re- </span><span class="c3">sulting in the vector ([a</span><span class="c1">3</span><span class="c7">],[a</span><span class="c1">7</span><span class="c7">]). Secondly, LSP selects the final </span><span class="c3">answer &#10214;[a</span><span class="c18">7</span><span class="c3">]&#10215; from ([a</span><span class="c18">3</span><span class="c3">],[a</span><span class="c18">7</span><span class="c3">]) using &#10214;</span><span class="c14">v</span><span class="c18">2</span><span class="c3">&#10215;, by treating the ci- phertext of &epsilon;</span><span class="c1">1 </span><span class="c7">as a plaintext of &epsilon;</span><span class="c1">2 </span><span class="c7">in Theorem </span><span class="c84">3.1</span><span class="c7">. u</span><span class="c1">c </span><span class="c7">can decrypt </span><span class="c3">&#10214;[aassume In </span><span class="c1">7</span><span class="c7">]&#10215; </span><span class="c3">general, </span><span class="c7">two </span><span class="c3">that </span><span class="c7">times </span><span class="c3">&delta;if </span><span class="c9">&prime;</span><span class="c3">/&omega; the </span><span class="c7">to </span><span class="c3">is length </span><span class="c7">obtain </span><span class="c3">an integer of</span><span class="c14">v</span><span class="c18">2 </span><span class="c7">the plaintext </span><span class="c3">by is &omega;, padding the length </span><span class="c7">query </span><span class="c3">0&rsquo;s at of</span><span class="c14">v</span><span class="c18">1 </span><span class="c7">answer </span><span class="c3">the is end &delta;</span><span class="c7">a</span><span class="c9">&prime;</span><span class="c1">7</span><span class="c7">. </span></p><p class="c50"><span class="c3">/&omega;. of </span><span class="c14">v </span><span class="c3">We if necessary. We want to choose &omega; that minimizes the total commu- nication cost between users and LSP. We focus on the ciphertexts transmitted between u</span><span class="c1">c </span><span class="c7">and LSP because the plaintext location </span><span class="c3">sets transmitted between users and LSP remain unchanged. The length of a ciphertext of length of a ciphertext of length of a ciphertext with &epsilon;</span><span class="c18">2</span><span class="c3">, which is &epsilon;</span><span class="c1">1</span><span class="c7">, which is </span><span class="c3">&epsilon;</span><span class="c1">1</span><span class="c7">. We want </span><span class="c3">in </span><span class="c7">in the </span><span class="c3">Z</span><span class="c7">Z</span><span class="c1">N N </span><span class="c36">3</span><span class="c3">, is about twice the </span><span class="c36">2</span><span class="c3">. Let L</span><span class="c1">e </span><span class="c7">denote the integer &omega; such that </span></p><p class="c6"><span class="c3">minimize </span><span class="c1">&omega; &isin;N</span><span class="c61">&le;d </span><span class="c3">cost(&omega;) = (2&omega; +&delta;</span><span class="c9">&prime;</span><span class="c3">/&omega; + 2m) &middot; L</span><span class="c1">e </span><span class="c7">(18) </span><span class="c3">where the first term accounts for the length of &#10214;</span><span class="c14">v</span><span class="c1">2</span><span class="c7">&#10215;, the sec- </span><span class="c3">ond term accounts for the length of [</span><span class="c14">v</span><span class="c1">1</span><span class="c7">], and the third term </span><span class="c3">accounts for the length of the returned answer (m is the number of ciphertexts for Eqn (</span><span class="c5">18</span><span class="c3">) communication is the required cost nearest cost for &asymp; integer 2(storing </span><span class="c30">&radic;</span><span class="c3">2&delta;</span><span class="c9">&prime; </span><span class="c3">to +m) an </span><span class="c30">&radic;</span><span class="c3">&delta;answer). </span><span class="c9">&prime;</span><span class="c3">&middot; /2, L</span><span class="c1">e</span><span class="c7">. </span></p><p class="c25"><span class="c3">with The the optimal &omega; minimum </span></p><p class="c50"><span class="c3">In comparison, the communication cost of using the original encrypted indicator vector [</span><span class="c14">v</span><span class="c3">] is cost</span><span class="c9">&prime; </span><span class="c3">= (&delta;</span><span class="c9">&prime; </span><span class="c3">+m) &middot; L</span><span class="c18">e</span><span class="c3">, where &delta;</span><span class="c9">&prime; </span><span class="c3">accounts for the length of [</span><span class="c14">v</span><span class="c3">] and m accounts for the length of the returned when 2</span><span class="c30">&radic;</span><span class="c3">2&delta;</span><span class="c9">&prime; </span><span class="c3">cost &lt; &lt; answer. cost </span><span class="c9">&prime;</span><span class="c3">, or The 2</span><span class="c30">&radic;</span><span class="c3">2&delta;above </span><span class="c9">&prime; </span><span class="c3">&lt; &delta;optimization </span><span class="c9">&prime; </span><span class="c3">&minus;m. Since 2reduces </span><span class="c30">&radic;</span><span class="c3">2&delta;</span><span class="c9">&prime; </span><span class="c3">is positive, the cost </span></p><p class="c6"><span class="c3">&delta; </span><span class="c9">&prime; </span><span class="c3">&minus; m holds only if &delta;</span><span class="c9">&prime; </span><span class="c3">&gt; m, and in this case, we have &delta;</span><span class="c9">&prime;2 </span><span class="c3">+ b&delta;</span><span class="c9">&prime; </span><span class="c3">+ c &gt; 0, where b = &minus;(2m + 8) and c = m</span><span class="c9">2</span><span class="c3">. The solutions for &delta;</span><span class="c9">&prime;2 </span><span class="c3">+ b&delta;</span><span class="c9">&prime; </span><span class="c3">+ c &gt; 0 are &delta;</span><span class="c9">&prime; </span><span class="c3">&gt; r</span><span class="c1">1 </span><span class="c7">or &delta;</span><span class="c18">&prime; </span><span class="c7">&lt; r</span><span class="c1">2</span><span class="c7">, where </span></p><p class="c25"><span class="c88">283 </span></p><p class="c25"><span class="c74">v </span></p><p class="c25"><span class="c3">Table 2: Performance analysis </span></p><p class="c25"><span class="c3">PPGNN Total Communication Cost O(nd)L</span><span class="c1">l </span><span class="c3">+O(&delta;</span><span class="c9">&prime;</span><span class="c3">)L</span><span class="c1">e </span><span class="c7">+O(k)L</span><span class="c1">e </span><span class="c3">User Computational Cost O(nd)C</span><span class="c1">l </span><span class="c3">+O(&delta;</span><span class="c9">&prime;</span><span class="c3">)C</span><span class="c18">e </span><span class="c3">+O(k)C</span><span class="c18">e </span><span class="c3">LSP Computational Cost O(&delta;</span><span class="c9">&prime;</span><span class="c3">)(C</span><span class="c1">q </span><span class="c7">+C</span><span class="c1">s</span><span class="c7">) +O(&delta;</span><span class="c18">&prime;</span><span class="c7">k)C</span><span class="c1">e </span><span class="c3">PPGNN-OPT </span></p><p class="c50"><span class="c7">O(nd)L</span><span class="c1">l </span><span class="c3">O(nd)C</span><span class="c1">l </span><span class="c3">+O(+O(</span><span class="c30">&radic;&radic;</span><span class="c3">&delta;&delta;</span><span class="c9">&prime;&prime;</span><span class="c3">)L)C</span><span class="c18">e </span><span class="c1">e </span><span class="c7">O(&delta;</span><span class="c18">&prime;</span><span class="c7">)(C</span><span class="c1">q </span><span class="c7">+C</span><span class="c1">s</span><span class="c7">) +O(&delta;+ O(k)L</span><span class="c1">e </span><span class="c3">+O(k)C</span><span class="c18">e &prime;</span><span class="c7">k)C</span><span class="c1">e </span><span class="c7">+ O(</span><span class="c3">&radic;</span><span class="c7">&delta;</span><span class="c18">&prime;</span><span class="c7">k)C</span><span class="c1">e </span><span class="c3">r</span><span class="c1">1 </span><span class="c3">since </span><span class="c7">= m + 4 + 2</span><span class="c3">&radic;</span><span class="c7">2m </span><span class="c3">&delta;</span><span class="c9">&prime; </span><span class="c3">&gt; m and r</span><span class="c18">2 </span><span class="c7">+ 4 </span><span class="c3">&lt; m, </span><span class="c7">and </span><span class="c3">only </span><span class="c7">r</span><span class="c1">2 </span><span class="c3">&delta;</span><span class="c7">= </span><span class="c9">&prime; </span><span class="c7">m + 4 &minus; 2</span><span class="c3">&radic;</span><span class="c7">2m + 4. However, </span></p><p class="c25"><span class="c3">&gt; r</span><span class="c18">1 </span><span class="c3">can be the solution. In conclusion, on the communication cost, PPGNN-OPT out- performs PPGNN if and only if &delta;</span><span class="c9">&prime; </span><span class="c3">&gt; r</span><span class="c1">1 </span><span class="c7">holds. Usually k is not </span><span class="c3">very large and several POIs&rsquo; information can be encoded into one big integer, therefore m is small and PPGNN-OPT can reduce the cost. </span></p><p class="c25"><span class="c32">7 PERFORMANCE ANALYSIS </span><span class="c3">Table </span><span class="c5">2 </span><span class="c3">summarizes the performance analysis of the PPGNN and PPGNN-OPT solutions in terms of communication cost, user computational cost, and LSP computational cost. </span></p><p class="c50"><span class="c3">Communication cost. Let L</span><span class="c1">l </span><span class="c3">and L</span><span class="c1">e </span><span class="c7">denote the length of a </span><span class="c3">location and the length of a ciphertext of &epsilon;</span><span class="c1">1</span><span class="c7">, respectively. The </span><span class="c3">communication cost of PPGNN includes: n location sets with size d each, i.e., O(nd)L</span><span class="c1">l</span><span class="c3">, [</span><span class="c14">v</span><span class="c3">] with size &delta;</span><span class="c9">&prime;</span><span class="c3">, i.e., O(&delta;</span><span class="c9">&prime;</span><span class="c3">)L</span><span class="c1">e</span><span class="c7">, the returned </span><span class="c3">answer with m encrypted integers that is proportional to the number O(nd)L</span><span class="c1">l </span><span class="c3">of POI to be retrieved + O(&delta;</span><span class="c9">&prime;</span><span class="c3">)L</span><span class="c1">e </span><span class="c7">+ O(k)L</span><span class="c1">e</span><span class="c7">. </span><span class="c3">k, i.e., O(k)L</span><span class="c18">e</span><span class="c3">. The total cost is </span><span class="c7">With PPGNN-OPT, the cost for </span><span class="c3">O(location </span><span class="c30">&radic;</span><span class="c3">&delta;</span><span class="c9">&prime;</span><span class="c3">)L</span><span class="c18">e </span><span class="c3">O(nd)L</span><span class="c1">l </span><span class="c3">sets does not change, + + O(O(k)L</span><span class="c18">e </span><span class="c30">&radic;</span><span class="c3">&delta;</span><span class="c9">&prime;</span><span class="c3">)L</span><span class="c1">e </span><span class="c3">(see </span><span class="c7">+O(k)L</span><span class="c3">Section </span><span class="c1">e</span><span class="c7">. </span></p><p class="c25"><span class="c3">but the cost for ciphertexts is </span><span class="c5">6</span><span class="c3">). Therefore, the total cost is </span></p><p class="c50"><span class="c3">User computational cost. LetC</span><span class="c1">l </span><span class="c3">denote the cost for generat- ing a dummy location, andC</span><span class="c18">e </span><span class="c3">denote the cost for execution on a ciphertext of &epsilon;</span><span class="c1">1 </span><span class="c7">(e.g., encryption, decryption). The user computa- </span><span class="c3">tional cost of PPGNN includes: location sets with sized generated by all puted i.e.,O(k)Cthe users, i.e., O(nd)Cbyu</span><span class="c1">c</span><span class="c7">, i.e., O(&delta;</span><span class="c18">&prime;</span><span class="c7">)C</span><span class="c1">e</span><span class="c7">, </span><span class="c1">e</span><span class="c7">. The total cost </span><span class="c1">l</span><span class="c3">, encryption of [</span><span class="c14">v</span><span class="c3">] with size &delta;</span><span class="c9">&prime; </span><span class="c7">and decryption of the returned answer, isO(nd)C</span><span class="c1">l </span><span class="c3">+O(&delta;</span><span class="c9">&prime;</span><span class="c3">)C</span><span class="c1">e </span><span class="c7">+O(k)C</span><span class="c1">e</span><span class="c7">. Similar </span><span class="c3">com- </span></p><p class="c25"><span class="c3">to cost the is analysis O(nd)C</span><span class="c1">l </span><span class="c3">of +O(communication </span><span class="c30">&radic;</span><span class="c3">&delta;</span><span class="c9">&prime;</span><span class="c3">)C</span><span class="c1">e </span><span class="c3">cost, for PPGNN-OPT, the total </span></p><p class="c50"><span class="c7">+O(k)C</span><span class="c1">e</span><span class="c7">. </span><span class="c3">LSP computational cost. Let C</span><span class="c1">q </span><span class="c7">denote the cost for execut- </span><span class="c3">ing a kGNN query (e.g., MBM algorithm [</span><span class="c22">24</span><span class="c3">]), andC</span><span class="c18">s </span><span class="c3">denote the cost for answer sanitation for one candidate query. The LSP com- putational cost of PPGNN includes: kGNN queries and answer sanitation private the total selection cost forO(&delta;is O(&delta;on&delta;</span><span class="c9">&prime;</span><span class="c3">) </span><span class="c9">&prime;</span><span class="c3">candidate )(C</span><span class="c9">&prime; </span><span class="c3">answers </span><span class="c1">q </span><span class="c7">+C</span><span class="c1">s</span><span class="c7">)+O(&delta;</span><span class="c3">queries, with sizem, </span><span class="c18">&prime;</span><span class="c7">k)C</span><span class="c3">i.e.,O(&delta;</span><span class="c1">e</span><span class="c7">. </span><span class="c3">i.e.,O(&delta;</span><span class="c7">For </span><span class="c9">&prime;</span><span class="c3">)(C</span><span class="c18">q</span><span class="c3">+C</span><span class="c18">s</span><span class="c3">), </span><span class="c7">PPGNN-OPT, </span><span class="c9">&prime;</span><span class="c3">k)C</span><span class="c1">e</span><span class="c7">. </span><span class="c3">and </span><span class="c7">Hence, </span><span class="c3">the </span></p><p class="c50"><span class="c7">the </span><span class="c3">costs but the for cost kGNN for query private and selection answer is sanitation O(&delta;</span><span class="c9">&prime;</span><span class="c3">k)C</span><span class="c18">e </span><span class="c3">remain + O(</span><span class="c30">&radic;</span><span class="c3">unchanged, &delta;</span><span class="c9">&prime;</span><span class="c3">k)C</span><span class="c18">e </span><span class="c3">be- cause operates swers. of The the on total O(&delta;two cost </span><span class="c9">&prime;</span><span class="c3">) phases answers is O(&delta;private </span><span class="c9">&prime;</span><span class="c3">and )(C</span><span class="c1">q </span><span class="c3">the selection, </span><span class="c7">+C</span><span class="c3">second </span><span class="c1">s</span><span class="c7">) +O(&delta;</span><span class="c3">where phase </span><span class="c18">&prime;</span><span class="c7">k)C</span><span class="c1">e </span><span class="c3">the on </span><span class="c7">+O(</span><span class="c3">O(first &radic;</span><span class="c30">&radic;</span><span class="c7">&delta;</span><span class="c3">&delta;phase </span><span class="c18">&prime;</span><span class="c9">&prime;</span><span class="c7">k)C</span><span class="c3">) an- </span><span class="c1">e</span><span class="c7">. </span><span class="c3">In summary, the communication cost of PPGNN-OPT is asymp- totically better than that of PPGNN. However, since the above analysis ignores constant coefficients, in practice, whether PPGNN- OPT is better depends on &delta; </span><span class="c9">&prime; </span><span class="c3">and m, as discussed at the end of Section </span><span class="c5">6 </span><span class="c3">(note thatm = xk, where x is the number of big integers needed to encode one POI). The comparison on user computa- tional cost is similar. The LSP computational cost of PPGNN-OPT is always larger than PPGNN because the second private selection is an extra cost comparing to PPGNN. We will experimentally compare the two solutions in Section </span><span class="c5">8</span><span class="c3">. </span></p><p class="c25"><span class="c32">8 EXPERIMENTS </span><span class="c3">We evaluated the performance of PPGNN (Section </span><span class="c5">4.2</span><span class="c3">), PPGNN- OPT (Section </span><span class="c5">6</span><span class="c3">), and the Naive solution (the beginning of Section </span><span class="c5">4</span><span class="c3">). Since the baseline methods for n = 1 and n &gt; 1 are different, we consider the single user query scenario (n = 1) in Section </span><span class="c5">8.2</span><span class="c3">, and the group query scenario (n &gt; 1) in Section </span><span class="c5">8.3</span><span class="c3">. </span></p><p class="c25"><span class="c32">8.1 Experimental Setup </span><span class="c3">We conducted experiments on a machine with Intel (R) Core (TM) i7-3770 CPU @ 3.40 GHz&times;8 machine with 15.6G of RAM, running Ubuntu 16.04.1 LTS. All algorithms were implemented in C++. The classic Minimum Bounding Method (MBM) [</span><span class="c22">24</span><span class="c3">] is applied as our plaintext kGNN algorithm in PPGNN, PPGNN-OPT, and the Naive solution, and the aggregation function F is sum. We employed the GMP</span><span class="c86">3 </span><span class="c3">library for big integer computation and libhcs</span><span class="c86">4 </span><span class="c3">library for operations of the generalized Paillier scheme. Thekeysize for &epsilon;</span><span class="c1">1 </span><span class="c7">is 1024 bits and thekeysize for &epsilon;</span><span class="c1">2 </span><span class="c7">is 2048. Table </span><span class="c5">3 </span><span class="c3">summarizes all parameters and their ranges. </span></p><p class="c6"><span class="c3">Dataset. We used a real-world dataset Sequoia</span><span class="c86">5</span><span class="c3">, which is widely used in previous studies [</span><span class="c22">12</span><span class="c3">&ndash;</span><span class="c22">14</span><span class="c3">, </span><span class="c22">27</span><span class="c3">, </span><span class="c22">36</span><span class="c3">]. The dataset con- tains 62556 POIs from California, including the coordinate and name. As in these previous works, the location space is normal- ized into a square space, and the real location for every user in a group query was randomly generated as a point in this space. The coordinates of POIs (8 bytes per POI) are returned as the query answer. </span></p><p class="c6"><span class="c3">Baselines. For n = 1, we choose the approximate private kNN query approach, APNN, in [</span><span class="c22">36</span><span class="c3">] as the baseline. In APNN, LSP partitions the data space into grid cells and pre-computes kNN results with respect to the center of each cell and encrypts them. At the query time, the user chooses a square cloak-region containing her location which consists of b</span><span class="c9">2 </span><span class="c3">cells, and initiates a two-stages cryptographic protocol to retrieve the desired answer. The protocol ensures that LSP does not know which cell the user is located in, nor which answer is retrieved, which ensures Privacy I-II with the privacy level b</span><span class="c9">2</span><span class="c3">, and the user can only decrypt the requested answer, which ensures Privacy III. In our experiments, APNN has a query cloak-region consisting of 5</span><span class="c9">2 </span><span class="c3">grid cells, which is equivalent to our default setting d = 25 for Privacy I. Note that APNN produces only approximate answers and relies on pre-computation of kNN results with respect to the center of every cell. This method is not suitable if the exact answer is required or if the database is dynamic. Also, it cannot be extended to the group query scenario because the number of possible queries is significantly large. We did not consider other approaches such as [</span><span class="c22">12</span><span class="c3">, </span><span class="c22">27</span><span class="c3">] because they are less efficient than APNN according to [</span><span class="c22">36</span><span class="c3">]. </span></p><p class="c6"><span class="c3">For n &gt; 1, the first baseline is the incremental pruning private filter (IPPF) algorithm in [</span><span class="c22">14</span><span class="c3">], which is the first work considering users&rsquo; location privacy in the kGNN query. With the cloak-region technique, IPPF ensures Privacy I-II but notPrivacy III-IV. The </span></p><p class="c25"><span class="c36">3</span><span class="c12">http://gmplib.org </span><span class="c36">4</span><span class="c12">https://github.com/tiehuis/libhcs </span><span class="c36">5</span><span class="c12">http://chorochronos.datastories.org/?q=node/58 </span></p><p class="c25"><span class="c88">284 </span></p><p class="c6"><span class="c3">second baseline is the group location privacy (GLP) algorithm in [</span><span class="c22">2</span><span class="c3">], which applies a secure multiparty computation technique for the users to compute their centroid, and LSP returns the kNN query answer with respect to the centroid. GLP ensures Privacy I and III, but not Privacy II and IV. A more detailed discussion for IPPF and GLP solutions can be found in Section </span><span class="c5">9</span><span class="c3">. </span></p><p class="c6"><span class="c3">Metrics. We measured three dominating costs for the queries: the total communication cost (including communications between the user group and LSP, as well as the communications within the user group), the total user cost (the sum of all users&rsquo; computational cost), and the LSP cost (all the computations execute on LSP during the query process). In the group query scenario, we also evaluated the number of POIs returned to the users, an indicator of the quality of the answer while resisting the full user collusion inequality attack. We executed 500 queries and reported the average cost. </span></p><p class="c25"><span class="c3">For the discussion below, the reader is referred to Table </span><span class="c5">3 </span><span class="c3">for the ranges and default settings of all parameters. </span></p><p class="c25"><span class="c3">Table 3: Parameters evaluated </span></p><p class="c25"><span class="c3">Parameter Range Default n = 1 </span><span class="c30">Privacy I parameter (d) </span><span class="c3">POI to be retrieved (k) </span><span class="c30">[5, 50] </span><span class="c3">[2, 32] </span><span class="c30">25 </span></p><p class="c25"><span class="c3">8 </span></p><p class="c25"><span class="c3">n &gt; 1 </span></p><p class="c25"><span class="c3">Privacy II parameter (&delta;) [25, 200] 100 POI to be retrieved (k) [2, 32] 8 user number (n) [2, 32] 8 Privacy IV parameter (&theta;</span><span class="c18">0</span><span class="c3">) [0.01, 0.1] 0.05 </span></p><p class="c25"><span class="c32">8.2 Evaluation for Single User Query (n = 1) </span><span class="c3">For n = 1, we evaluated PPGNN and PPGNN-OPT by varying d and k. We did not evaluate Naive that is designed for n &gt; 1. </span></p><p class="c6"><span class="c3">Varing d: Figure </span><span class="c5">5a</span><span class="c3">-</span><span class="c5">5c </span><span class="c3">compares the three costs of PPGNN and PPGNN-OPT for varyingd. Note that APNN does not depend on d and is not included. All three costs increase as d increases because each user needs to generate more dummy locations and executes more encryption on the indicator vector, and LSP needs to compute more candidate queries and select the final answer from more query answers. Figure </span><span class="c5">5a </span><span class="c3">shows that d = 15 is the threshold for PPGNN-OPT to outperform PPGNN regarding the communication cost. Whend &ge; 15 (note that&delta;</span><span class="c9">&prime; </span><span class="c3">= d whenn = 1), the communication cost reduction of PPGNN-OPT starts to take effect, which is consistent with the analysis in Section </span><span class="c5">7</span><span class="c3">. Figure </span><span class="c5">5b </span><span class="c3">shows a similar trend for the user cost, but with a different threshold d = 25 for PPGNN-OPT to beat PPGNN, since the coefficients in Eqn (</span><span class="c5">18</span><span class="c3">) are different with respect to user cost. Usually the cost of operation using &epsilon;</span><span class="c1">2 </span><span class="c7">consumes more than 2 </span><span class="c3">times (&asymp;3 times in our experiments) than that using &epsilon;</span><span class="c1">1</span><span class="c7">, leading to </span><span class="c3">a larger threshold required. For the LSP cost (Figure </span><span class="c5">5c</span><span class="c3">), PPGNN always performs better because LSP needs to execute two-phases private selection in PPGNN-OPT. In the mobile user scenario, reducing the communication cost and the user cost has a priority over reducing the LSP cost. </span></p><p class="c6"><span class="c3">Varying k: Figure </span><span class="c5">5d</span><span class="c3">-</span><span class="c5">5f </span><span class="c3">reports the performance of PPGNN, PPGNN-OPT, and APNN for varyingk. The communication costs (Figure </span><span class="c5">5d</span><span class="c3">) of the three solutions have a staged growth when k goes up because 15 POIs information can be encoded by a big integer in our settings. Figure </span><span class="c5">5e </span><span class="c3">shows a similar trend on the user cost for the three solutions. For PPGNN and PPGNN-OPT, the LSP cost (Figure </span><span class="c5">5f</span><span class="c3">) increases when k becomes larger because the kNN query time and private selection time increase. APNN has </span></p><p class="c25"><span class="c118">10000 </span><span class="c111">PPGNN PPGNN-OPT APNN </span><span class="c116">) etyb(t soC. mmo</span><span class="c114">C</span><span class="c136">8642</span><span class="c33">010 20 30 40 50 </span></p><p class="c25"><span class="c118">0.25 </span><span class="c114">d </span><span class="c27">x10</span><span class="c161">3 </span></p><p class="c25"><span class="c34">)ces(t soCr es</span><span class="c0">U</span><span class="c38">0.2 0.1 </span></p><p class="c25"><span class="c4">(b) User cost vs. d </span></p><p class="c25"><span class="c34">)ces(t soCP S</span><span class="c90">L</span><span class="c46">0.2 0.1 </span></p><p class="c25"><span class="c4">(a) Comm. cost vs. d </span></p><p class="c25"><span class="c4">(c) LSP cost vs. d </span></p><p class="c25"><span class="c33">4 8 16 32 </span></p><p class="c25"><span class="c53">k </span></p><p class="c25"><span class="c38">0 </span></p><p class="c25"><span class="c38">10 20 30 40 50 </span></p><p class="c25"><span class="c46">0 </span></p><p class="c25"><span class="c46">10 20 30 40 50 </span><span class="c0">d </span></p><p class="c25"><span class="c90">d </span></p><p class="c25"><span class="c141">) etyb(t soC. mmo</span><span class="c53">C</span><span class="c124">8642</span><span class="c33">0</span><span class="c46">0.2 </span><span class="c78">x10</span><span class="c134">3 </span></p><p class="c25"><span class="c34">)ces(t soCr es</span><span class="c90">U</span><span class="c46">0.1 </span></p><p class="c25"><span class="c4">(d) Comm. cost vs. k </span></p><p class="c25"><span class="c4">(e) User cost vs. k </span></p><p class="c25"><span class="c34">)ces(t soCP S</span><span class="c0">L</span><span class="c46">0.3 </span></p><p class="c25"><span class="c4">(f) LSP cost vs. k </span></p><p class="c25"><span class="c3">Figure 5: Effect of parameters when n = 1 </span></p><p class="c6"><span class="c3">the lowest LSP computational cost because of pre-computedkNN query answers for all grid cells. This computational gain is paid by returning only approximate kNN answers and the potentially expensive update cost for recomputing all kNN answers for a dynamic database. </span></p><p class="c25"><span class="c32">8.3 Evaluation for Group Query (n &gt; 1) </span><span class="c3">When n &gt; 1, we evaluated PPGNN, PPGNN-OPT and Naive in Section </span><span class="c5">8.3.1 </span><span class="c3">by varying &delta;, k, n, and &theta;</span><span class="c1">0</span><span class="c7">. We set d = 25 by </span><span class="c3">default and did not show its effect because of the relatively stable performance. We experimentally tested for every (n,d,&delta;) where n &isin; [2, 32], d &isin; [5, 50], &delta; &isin; [50, 200] and the average difference between &delta;</span><span class="c9">&prime; </span><span class="c3">and &delta; is approximately 1, i.e., &delta;</span><span class="c9">&prime; </span><span class="c3">&asymp; &delta;. We used the commonly used confidence levels&gamma; = 0.05, &eta; = 0.2 and &phi; = 0.1 in all experiments in the hypothesis testing. The comparison with the baselines IPPF and GLP, which have only two parameters same as ours, k and n, is reported in Section </span><span class="c5">8.3.2</span><span class="c3">. </span></p><p class="c50"><span class="c3">8.3.1 Evaluation of Our Approaches. Varying &delta;: Figure </span><span class="c5">6a</span><span class="c3">-</span><span class="c5">6c </span><span class="c3">shows the comparison for varying &delta;. Unlike the comparison for n = 1 in Section </span><span class="c5">8.2</span><span class="c3">, the communication cost and user cost of PPGNN-OPT are much smaller than those of PPGNN and this ad- vantage increases as &delta; increases. In fact, the size of the encrypted O(indicator </span><span class="c30">&radic;</span><span class="c3">&delta;</span><span class="c9">&prime;</span><span class="c3">), whereas vectors the ([</span><span class="c14">v</span><span class="c1">1</span><span class="c7">], </span><span class="c3">size </span><span class="c7">&#10214;</span><span class="c66">v</span><span class="c3">of </span><span class="c1">2</span><span class="c7">&#10215;) </span><span class="c3">the </span><span class="c7">in </span><span class="c3">encrypted </span><span class="c7">PPGNN-OPT </span><span class="c3">indicator </span><span class="c7">is proportional </span><span class="c3">vector ([</span><span class="c14">v</span><span class="c3">]) </span><span class="c7">to </span></p><p class="c6"><span class="c3">in PPGNN is proportional to O(&delta;</span><span class="c9">&prime;</span><span class="c3">). Therefore, for a large enough &delta;, although the encryption using &epsilon;</span><span class="c1">2 </span><span class="c7">in PPGNN-OPT consumes </span><span class="c3">about three times the cost of the encryption using &epsilon;</span><span class="c1">1</span><span class="c7">, the user </span><span class="c3">cost is still much lower. </span></p><p class="c6"><span class="c3">The Naive solution incurs the most communication cost be- cause every user in the group needs to send extra &delta; &minus;d dummy locations. The LSP costs are almost the same for the three solu- tions, and are much larger than that for the single user query. Because when n &gt; 1, the answer sanitation in Section </span><span class="c5">5.1 </span><span class="c3">is ac- tivated to ensure Privacy IV, and this operation dominates the LSP cost. We will discuss more about the LSP cost for answer sanitation in Section </span><span class="c5">8.3.2</span><span class="c3">. </span></p><p class="c6"><span class="c3">Varing k: </span><span class="c5">6d</span><span class="c3">-</span><span class="c5">6f </span><span class="c3">shows the comparison for varying k. The relative comparison of the three solutions is similar to Figure </span><span class="c5">6a</span><span class="c3">- </span><span class="c5">6c</span><span class="c3">, except that the communication cost and user cost are relatively stable as k increases, with PPGNN-OPT being the best performer. Figure </span><span class="c5">6f </span><span class="c3">shows that, when k increases, the LSP costs for the </span></p><p class="c25"><span class="c88">285 </span></p><p class="c25"><span class="c46">0.2 </span></p><p class="c25"><span class="c46">0.1 </span></p><p class="c25"><span class="c46">0 </span></p><p class="c25"><span class="c46">4 8 16 32 </span></p><p class="c25"><span class="c46">0 </span></p><p class="c25"><span class="c46">4 8 16 32 </span><span class="c90">k </span></p><p class="c25"><span class="c0">k </span></p><p class="c25"><span class="c24">4 </span><span class="c54">PPGNN PPGNN-OPT Naive </span><span class="c124">4 10</span><span class="c97">4 </span><span class="c152">10</span><span class="c156">4 </span><span class="c24">0.5 </span><span class="c124">3210</span><span class="c33">50 100 150 200 </span><span class="c4">(a) Comm. cost vs. &delta; </span></p><p class="c25"><span class="c165">3 210</span><span class="c119">50 100 150 200 </span><span class="c4">(c) LSP cost vs. &delta; </span></p><p class="c25"><span class="c93">4 8 16 32 </span></p><p class="c25"><span class="c114">k </span></p><p class="c25"><span class="c46">0.5 </span></p><p class="c25"><span class="c46">0.4 </span></p><p class="c25"><span class="c46">0.3 </span></p><p class="c25"><span class="c46">0.2 </span></p><p class="c25"><span class="c46">0.1 </span></p><p class="c50"><span class="c92">0 </span><span class="c46">50 100 150 200 </span><span class="c4">(b) User cost vs. &delta; </span><span class="c116">) etyb(t soC. mmo</span><span class="c114">C</span><span class="c136">321</span><span class="c93">0</span><span class="c136">10</span><span class="c110">4 </span></p><p class="c42"><span class="c55">)ces(t soCr es</span><span class="c0">U</span><span class="c38">0.3 </span><span class="c34">)ces(t soCP S</span><span class="c0">L</span><span class="c28">21</span><span class="c46">0</span><span class="c4">(d) Comm. cost vs. k </span></p><p class="c25"><span class="c4">(e) User cost vs. k </span></p><p class="c25"><span class="c4">(f) LSP cost vs. k </span></p><p class="c25"><span class="c33">4 8 16 32 </span></p><p class="c25"><span class="c53">n </span></p><p class="c25"><span class="c38">0.2 </span></p><p class="c25"><span class="c38">0.1 </span></p><p class="c25"><span class="c38">0 </span></p><p class="c25"><span class="c38">4 8 16 32 </span></p><p class="c25"><span class="c46">4 8 16 32 </span><span class="c0">k </span></p><p class="c25"><span class="c0">k </span></p><p class="c42"><span class="c116">) etyb(t soC. mmo</span><span class="c53">C</span><span class="c136">54321</span><span class="c33">0</span><span class="c46">0</span><span class="c136">10</span><span class="c97">4 </span><span class="c34">)ces(t soCr es</span><span class="c0">U</span><span class="c46">0.3 0.2 </span></p><p class="c42"><span class="c46">0.1 </span><span class="c34">)ces(t soCP S</span><span class="c90">L</span><span class="c92">4321</span><span class="c4">(g) Comm. cost vs. n </span></p><p class="c25"><span class="c4">(h) User cost vs. n </span></p><p class="c25"><span class="c4">(i) LSP cost vs. n </span></p><p class="c25"><span class="c93">0.01 0.05 0.1 </span></p><p class="c25"><span class="c38">0 </span></p><p class="c25"><span class="c46">0 </span></p><p class="c25"><span class="c46">4 8 16 32 </span></p><p class="c25"><span class="c46">4 8 16 32 </span><span class="c0">n </span></p><p class="c25"><span class="c90">n </span></p><p class="c25"><span class="c100">3 10</span><span class="c154">4 </span></p><p class="c25"><span class="c100">21</span><span class="c93">0</span><span class="c4">(j) Comm. cost vs. &theta;</span><span class="c13">0 </span></p><p class="c25"><span class="c38">0.3 </span></p><p class="c25"><span class="c4">(k) User cost vs. &theta;</span><span class="c13">0 </span></p><p class="c50"><span class="c10">6 </span><span class="c38">0.2 </span><span class="c10">4</span><span class="c38">0.1 </span><span class="c10">2</span><span class="c38">0.01 0 </span></p><p class="c25"><span class="c38">0.05 0.1 </span></p><p class="c25"><span class="c104">0.01 00.05 0.1 </span></p><p class="c25"><span class="c142">0 </span></p><p class="c25"><span class="c119">0 </span></p><p class="c25"><span class="c4">(l) LSP cost vs. &theta;</span><span class="c13">0 </span></p><p class="c25"><span class="c3">Figure 6: Effect of parameters when n &gt; 1 </span></p><p class="c6"><span class="c3">three solutions first go up because the number of inequalities in answer sanitation increases, and become stable when k reaches a number since the number of safe POIs becomes stable as k increases (see Figure </span><span class="c5">7a</span><span class="c3">). </span></p><p class="c6"><span class="c3">Varing n: Figure </span><span class="c5">6g</span><span class="c3">-</span><span class="c5">6i </span><span class="c3">shows the comparison for varying n. The trend is similar to Figure </span><span class="c5">6a</span><span class="c3">-</span><span class="c5">6c</span><span class="c3">, with PPGNN-OPT being the best performer for the communication cost and user cost. For PPGNN and PPGNN-OPT, n does not affect the size of encrypted indicator vector(s), but for the Naive solution, every user needs to generate and send extra &delta; &minus;d dummy locations, which leads to the faster increase in the communication cost and user cost. The LSP cost of three solutions increases linearly because the total number of inequalities considered in the answer sanitation grows linearly with n. </span></p><p class="c6"><span class="c3">Varying &theta;</span><span class="c18">0</span><span class="c3">: Figure </span><span class="c5">6j</span><span class="c3">-</span><span class="c5">6l </span><span class="c3">shows the comparison for varying &theta;</span><span class="c1">0</span><span class="c7">. The communication cost and user cost are stable since &theta;</span><span class="c1">0 </span><span class="c3">only affects the computation on LSP through the sample size N</span><span class="c1">H </span><span class="c7">required as in Eqn (</span><span class="c84">17</span><span class="c7">). The LSP cost first decreases greatly </span><span class="c3">and becomes stable as &theta;</span><span class="c1">0 </span><span class="c7">increases because the sample size in </span><span class="c3">Eqn (</span><span class="c5">17</span><span class="c3">) behaves this way. In other words, a stronger Privacy IV level means a faster answer sanitation because fewer samples are required in the hypothesis testing. </span></p><p class="c6"><span class="c3">Number of POIs returned: Recall that the answer sanitation will remove some lower ranked POIs in the top-k answer to ensure Privacy IV under the full user collusion assumption. Thus, the number of POIs actually returned to the users could </span></p><p class="c25"><span class="c38">0</span><span class="c34">d enruteR# I O</span><span class="c0">P</span><span class="c28">642</span><span class="c121">PPGNN </span></p><p class="c25"><span class="c55">d enruteR# I O</span><span class="c0">P</span><span class="c28">642</span><span class="c121">PPGNN </span><span class="c46">0</span><span class="c4">(a) POI number vs. k </span></p><p class="c25"><span class="c4">(b) POI number vs. n </span></p><p class="c25"><span class="c10">6 </span><span class="c127">PPGNN </span></p><p class="c25"><span class="c10">42</span><span class="c46">4 8 16 32 </span></p><p class="c25"><span class="c38">4 8 16 32 </span></p><p class="c25"><span class="c104">0.01 00.05 0.1 </span><span class="c0">k </span></p><p class="c25"><span class="c0">n </span></p><p class="c25"><span class="c119">0 </span></p><p class="c25"><span class="c4">(c) POI number vs. &theta;</span><span class="c13">0 </span></p><p class="c25"><span class="c3">Figure 7: The number of POIs returned per answer </span></p><p class="c25"><span class="c72">2</span><span class="c136">10 </span><span class="c33">10</span><span class="c76">) c</span><span class="c72">e</span><span class="c128">s</span><span class="c110">4 </span></p><p class="c25"><span class="c43">PPGNN IPPF GLP PPGNN-NAS </span></p><p class="c25"><span class="c28">1 </span></p><p class="c25"><span class="c38">0.5</span><span class="c136">5</span><span class="c33">4 8 16 32 </span></p><p class="c25"><span class="c114">k </span></p><p class="c25"><span class="c4">(a) Comm. cost vs. k </span></p><p class="c42"><span class="c4">(b) User cost vs. k </span><span class="c34">)ces(t soCP S</span><span class="c0">L</span><span class="c28">21</span><span class="c33">0</span><span class="c46">0</span><span class="c4">(c) LSP cost vs. k </span></p><p class="c25"><span class="c33">4 8 16 32 </span></p><p class="c25"><span class="c53">n </span></p><p class="c25"><span class="c38">0 </span></p><p class="c25"><span class="c38">4 8 16 32 </span></p><p class="c25"><span class="c46">4 8 16 32 </span><span class="c0">k </span></p><p class="c25"><span class="c0">k </span></p><p class="c25"><span class="c34">)ces(t soCP S</span><span class="c90">L</span><span class="c28">4321</span><span class="c46">0</span><span class="c4">(f) LSP cost vs. n </span></p><p class="c25"><span class="c3">Figure 8: Comparison with other approaches. </span></p><p class="c6"><span class="c3">be smaller than k. This experiment will study how the answer sanitation affects this number. We only consider PPGNN because PPGNN-OPT and Naive will return the same answer as PPGNN. Note that k, n, and &theta;</span><span class="c18">0 </span><span class="c3">can affect this number, but &delta; cannot. </span></p><p class="c6"><span class="c3">Figure </span><span class="c5">7a</span><span class="c3">-</span><span class="c5">7c </span><span class="c3">shows the number of POIs returned per answer for varying k, n, and &theta;</span><span class="c18">0</span><span class="c3">. The default settings of k, n, and &theta;</span><span class="c18">0 </span><span class="c3">are 8, 8, and 0.01, respectively. In Figure </span><span class="c5">7a</span><span class="c3">, as k increases, the number of POIs returned first increases and then becomes stable around 4. This is because, withn = 8 and&theta;</span><span class="c18">0 </span><span class="c3">= 0.01, 4 inequalities usually lead to a successful inequality attack and a largerk has no additional impact. In Figure </span><span class="c5">7b</span><span class="c3">, the number of returned POIs rises slightly asn increases. At first glance, this seems counter-intuitive because ensuring no attack on more users is more restrictive. At a closer look, with more users involved in a query, the target user&rsquo;s location l</span><span class="c18">1</span><span class="c35">,</span><span class="c18">&lowast; </span><span class="c3">weights less in determining if the inequalities in Eqn (</span><span class="c5">14</span><span class="c3">) hold or not, therefore, there are more choices for l</span><span class="c1">1</span><span class="c48">,</span><span class="c1">&lowast;</span><span class="c7">, thus, a larger solution region for l</span><span class="c1">1</span><span class="c48">,</span><span class="c1">&lowast; </span><span class="c7">and it is easier to add </span><span class="c3">the next POI in the answer. The trend in Figure </span><span class="c5">7c </span><span class="c3">is expected because a larger&theta;</span><span class="c1">0 </span><span class="c7">leads to a stronger Privacy IV, consequently, </span><span class="c3">fewer POIs can be returned. </span></p><p class="c6"><span class="c3">To conclude, the top 2 to 5 POIs are still returned for a query even after the answer sanitation. In practice, such numbers are usually sufficient because the users might only need to select one from them. </span></p><p class="c6"><span class="c3">8.3.2 Comparison with Baseline Approaches. We compared PPGNN with the baselines IPPF and GLP for varyingk andn.d,&delta;, and &theta;</span><span class="c1">0 </span><span class="c7">specific to PPGNN are set to their default values. We only </span><span class="c3">consider PPGNN because the experiments above have shown that PPGNN-OPT is better than PPGNN. While PPGNN satisfies Privacy IV assuming full user collusion, let PPGNN-NAS denote </span></p><p class="c25"><span class="c88">286 </span></p><p class="c25"><span class="c124">3 10</span><span class="c97">5 </span></p><p class="c25"><span class="c124">21</span><span class="c33">0</span><span class="c4">(d) Comm. cost vs. n </span></p><p class="c25"><span class="c28">6 42</span><span class="c38">04 8 16 32 </span></p><p class="c25"><span class="c46">4 8 16 32 </span><span class="c0">n </span></p><p class="c25"><span class="c90">n </span></p><p class="c25"><span class="c4">(e) User cost vs. n </span></p><p class="c99"><span class="c3">Table 4: Comparison with existing work </span></p><p class="c157"><span class="c3">Group Size Approaches Technique Privacy I Privacy II Privacy III Privacy IV </span></p><p class="c166"><span class="c3">n = 1 </span></p><p class="c6 c45"><span class="c3">[</span><span class="c22">3</span><span class="c3">, </span><span class="c22">9</span><span class="c3">, </span><span class="c22">21</span><span class="c3">] Cloak-Region / / &times; - [</span><span class="c22">17</span><span class="c3">, </span><span class="c22">30</span><span class="c3">] Dummy / / &times; - [</span><span class="c22">13</span><span class="c3">, </span><span class="c22">26</span><span class="c3">] Private Information Retrieval / / &times; - [</span><span class="c22">1</span><span class="c3">, </span><span class="c22">34</span><span class="c3">, </span><span class="c22">37</span><span class="c3">] Perturbation / &times; / - [</span><span class="c22">12</span><span class="c3">, </span><span class="c22">27</span><span class="c3">, </span><span class="c22">36</span><span class="c3">] Hybrid Techniques / / / - Our approach Dummy+Paillier / / / - </span></p><p class="c151"><span class="c3">n &gt; 1 </span></p><p class="c6 c75"><span class="c3">[</span><span class="c22">14</span><span class="c3">] Cloak-Region / / &times; &times; [</span><span class="c22">2</span><span class="c3">] Secure Multiparty Computation / &times; / &times; Our approach Dummy+Paillier / / / / </span></p><p class="c150"><span class="c3">the relaxed PPGNN that satisfies Privacy IV assuming no user collusion. So PPGNN-NAS does not run the answer sanitation. For IPPF, we chose the query rectangle area (for each user) to be 0.0005% of the data space, which is comparable to choosing d = 25 locations (our default setting) as the location set from 5000,000 addresses in California</span><span class="c86">6</span><span class="c3">. For GLP, we chose the same keysize as PPGNN. </span></p><p class="c145"><span class="c3">Varying k: Figure </span><span class="c5">8a</span><span class="c3">-</span><span class="c5">8c </span><span class="c3">shows the comparison for varying k. The communication cost of IPPF is much larger than PPGNN and GLP. In fact, IPPF returns all the candidate POIs, which can be several thousands per query on average, to the users, and the users have to filter the candidate POIs. GLP consumes more user cost than PPGNN and IPPF because there are O(n</span><span class="c9">2</span><span class="c3">) cryp- tographic operations and every user has to transmit encrypted values to all other users. In Figure </span><span class="c5">8c</span><span class="c3">, the gap between PPGNN and PPGNN-NAS is the LSP time spent on the answer sanitation, which dominates the LSP cost. IPPF and GLP consume less LSP cost, however, IPPF cannot satisfy Privacy III and IV, and GLP cannot satisfy Privacy II and IV and provide only an approxi- mate answer. </span></p><p class="c164"><span class="c3">Varying n: Figure </span><span class="c5">8d</span><span class="c3">-</span><span class="c5">8f </span><span class="c3">shows the comparison for varying n. PPGNN is significantly communication efficient than IPPF and GLP. The communication cost for GLP increases quickly with n because the number of transmitted encrypted values is O(n</span><span class="c9">2</span><span class="c3">). There is a similar trend on the user cost. Again, Figure </span><span class="c5">8f </span><span class="c3">shows that PPGNN spent significant LSP time on the answer sanitation to deal with the full user collusion, whereas PPGNN-NAS has almost the same LSP time as IPPF and GLP. </span></p><p class="c112"><span class="c32">8.4 Summary </span><span class="c3">For n = 1, our solutions, PPGNN and PPGNN-OPT, are compara- ble with or better than the existing solution APNN that heavily relies on pre-computing the answers for all possible queries to reduce the run-time cost. However, APNN produces only ap- proximate answers and the pre-computation means an expensive update cost. For n &gt; 1, which is the main focus of this paper, PPGNN and PPGNN-OPT, have significantly smaller communi- cation cost and user cost than existing solutions IPPF and GLP while providing stronger privacy guarantees, i.e., Privacy I-IV, and PPGNN-OPT performs better than PPGNN in most cases. We believe that reducing the communication cost and user com- munication cost is the priority in the mobile user scenario as considered here. The pay for achieving the stronger privacy guar- antee is some increase in the LSP cost, especially when dealing with the full user collusion assumption for Privacy IV. To our knowledge, this is the first work considering this assumption. </span></p><p class="c41"><span class="c36">6</span><span class="c12">https://openaddresses.io/ </span></p><p class="c25 c96"><span class="c32">9 RELATED WORK </span><span class="c3">Most existing work focus on the single user query case, i.e.,n = 1. To protect Privacy I, some techniques obfuscate user&rsquo;s exact location in a cloak-region (CR) [</span><span class="c22">3</span><span class="c3">, </span><span class="c22">9</span><span class="c3">, </span><span class="c22">21</span><span class="c3">] or use dummy query locations [</span><span class="c22">17</span><span class="c3">, </span><span class="c22">30</span><span class="c3">]. Another technique [</span><span class="c22">13</span><span class="c3">, </span><span class="c22">26</span><span class="c3">] is based on pri- vate information retrieval (PIR), allowing the user to retrieve a particular record from LSP without revealing which record is retrieving. In these techniques, LSP needs to return a super-set of the exact query answer, which not only increases the commu- nication cost but also sacrifices Privacy III. Data transformation [</span><span class="c22">37</span><span class="c3">] and differential privacy approach [</span><span class="c22">1</span><span class="c3">, </span><span class="c22">34</span><span class="c3">] perturb user&rsquo;s exact location to a false location, so the query answer is approximate, and meanwhile, Privacy II is sacrificed because LSP knows the query answer. The approaches [</span><span class="c22">12</span><span class="c3">, </span><span class="c22">27</span><span class="c3">, </span><span class="c22">36</span><span class="c3">] that based on a hybrid of PIR and cryptography technique can protect Privacy I-III, but LSP needs to pre-compute the answers to all possible queries. This technique does not work for n &gt; 1 because of too many group queries. Also, if a POI information is updated, LSP needs to re-compute all answers, which is too expensive. </span></p><p class="c8"><span class="c3">For the group query scenario, i.e., n &gt; 1, Hashem et al. [</span><span class="c22">14</span><span class="c3">] obfuscates each user&rsquo;s exact location into a region, and LSP exe- cutes the kGNN query w.r.t. these regions, returning a super-set of the query answer. Beside the extra work of filtering the an- swer set by the users, this approach sacrifices Privacy III since extra POI information is returned to the users. Privacy IV is also violated because a user&rsquo;s exact location is compromised if its predecessor and successor collude in the filtering phase [</span><span class="c22">2</span><span class="c3">]. In the work by Talouki et al. [</span><span class="c22">2</span><span class="c3">], users compute their centroid by secure multiparty computation (SMC) [</span><span class="c22">35</span><span class="c3">] and LSP returns the kNN answer for that centroid. This approach cannot protect Privacy II andPrivacy IV because LSP knows the query answer and n &minus; 1 users can recover the last user&rsquo;s exact location by their own locations and the centroid. </span></p><p class="c106"><span class="c3">Table </span><span class="c5">4 </span><span class="c3">summarizes and compares the above works with our work. </span></p><p class="c31"><span class="c3">In the privacy preserving meeting location determination (PPMLD) [</span><span class="c22">5</span><span class="c3">, </span><span class="c22">16</span><span class="c3">, </span><span class="c22">31</span><span class="c3">], a group of users each chooses a preferred meeting location and send the encrypted locations to the server, who then selects the one to minimize the aggregate distance to all preferred locations. In our work, the query answer is selected from the POI database of LSP and the users specify their current locations, instead of preferred meeting locations. The PPMLD method cannot be adopted to our privacy preserving kGNN prob- lem because their cryptographic selection is specific to PPMLD. On the other hand, our approach can be adopted to PPMLD by replacing thekGNN building block with any existing non-privacy preserving meeting location determination solution. </span></p><p class="c62"><span class="c88">287 </span></p><p class="c81"><span class="c3">The data ownership and privacy implication in our problem are different from most works on secure query processing in the outsourcing database (ODB) model [</span><span class="c22">32</span><span class="c3">]. In ODB, the users and the data owner are trusted and the server is not trusted. The data owner outsources the encrypted database to the server and the user retrieves the query answer from the server. The privacy objective is to prevent the server from learning anything about the database and the user query. In our problem, LSP owns the data and multiple users jointly specify a query, and no party trusts anyone except herself. </span></p><p class="c158"><span class="c32">10 CONCLUSION </span><span class="c3">This work identifies four privacy objectives for the group k- nearest neighbor query, kGNN, and designs a privacy preserving kGNN solution, PPGNN. To our knowledge, this is the first work that address all of these privacy objectives. Though we consider kGNN, the proposed privacy preserving approach can be easily adopted to any group query because it treats the query answering (i.e., kGNN) as a black box. </span></p><p class="c133"><span class="c32">ACKNOWLEDGMENT </span><span class="c3">This work is supported by National Science Foundation of China (No.61532021, 61772537), National High Technology Research and Development Program of China (863) (No.2014AA015204), National Key R &amp; D program of China (No.2016YFB1000702), Na- tional Basic Research Program of China (973) (No.2014CB340403). Ke Wang&rsquo;s work was partially supported by a discovery grant from The Natural Sciences and Engineering Research Council of Canada (NSERC). This work was partially done when some authors worked in SA Center for Big Data Research in Renmin University of China. The SA Center is funded by Chinese National 111 Project Attracting International Talents in Data Engineering and Knowledge Engineering Research. </span></p><p class="c162"><span class="c32">REFERENCES </span></p><p class="c160"><span class="c19">[1] Miguel E. Andr&eacute;s, Nicol&aacute;s Emilio Bordenabe, Konstantinos Chatzikokolakis, and Catuscia Palamidessi. 2013. Geo-indistinguishability: differential privacy for location-based systems. In CCS. 901&ndash;914. [2] Maede Ashouri-Talouki, Ahmad Baraani-Dastjerdi, and Ali Aydin Sel&ccedil;uk. </span></p><p class="c109 c159"><span class="c19">2012. GLP: A cryptographic approach for group location privacy. Computer Communications 35, 12 (2012), 1527&ndash;1533. [3] Bhuvan Bamba, Ling Liu, P&eacute;ter Pesti, and Ting Wang. 2008. Supporting anonymous location queries in mobile environments with privacygrid. In WWW. 237&ndash;246. [4] Pietro Belotti, Christian Kirches, Sven Leyffer, Jeff Linderoth, James Luedtke, and Ashutosh Mahajan. 2013. Mixed-integer nonlinear optimization. Acta Numerica 22, 1&ndash;131. [5] Igor Bilogrevic, Murtuza Jadliwala, Vishal Joneja, K&uuml;bra Kalkan, Jean-Pierre Hubaux, and Imad Aad. 2014. Privacy-Preserving Optimal Meeting Location Determination on Mobile Devices. IEEE Trans. Information Forensics and Security 9, 7 (2014), 1141&ndash;1156. [6] Pierre Bonami, Mustafa Kilin&ccedil;, and Jeff Linderoth. 2012. Algorithms and Software for Convex Mixed Integer Nonlinear Programs. Springer New York, 1&ndash;39. [7] Sprinthall R. C. Basic Statistical Analysis (9th ed.). Pearson Education. [8] Sunoh Choi, Gabriel Ghinita, Hyo-Sang Lim, and Elisa Bertino. 2014. Secure kNN Query Processing in Untrusted Cloud Environments. TKDE 26, 11 (2014), 2818&ndash;2831. [9] Chi-Yin Chow, Mohamed F. Mokbel, and Xuan Liu. 2006. A peer-to-peer spatial cloaking algorithm for anonymous location-based service. In ACM-GIS. 171&ndash;178. [10] Ivan Damg&aring;rd and Mads Jurik. 2001. A Generalisation, a Simplification and Some Applications of Paillier&rsquo;s Probabilistic Public-Key System. In Public Key Cryptography. 119&ndash;136. [11] Joseph L Fleiss, Bruce Levin, and Myunghee Cho Paik. 2003. Statistical methods </span></p><p class="c109 c140"><span class="c19">for rates and proportions; 3rd ed. Wiley, Hoboken, NJ. [12] Gabriel Ghinita, Panos Kalnis, Murat Kantarcioglu, and Elisa Bertino. 2011. Approximate and exact hybrid algorithms for private nearest-neighbor queries with database protection. GeoInformatica 15, 4 (2011), 699&ndash;726. </span></p><p class="c25 c29"><span class="c19">[13] Gabriel Ghinita, Panos Kalnis, Ali Khoshgozaran, Cyrus Shahabi, and Kian-Lee Tan. 2008. Private queries in location based services: anonymizers are not necessary. In SIGMOD. 121&ndash;132. [14] Tanzima Hashem, Lars Kulik, and Rui Zhang. 2010. Privacy preserving group </span></p><p class="c109 c125"><span class="c19">nearest neighbor queries. In EDBT. 489&ndash;500. [15] D.C. Howell. 2013. Statistical Methods for Psychology. Wadsworth Cengage </span></p><p class="c47"><span class="c19">Learning. [16] Yan Huang and Roopa Vishwanathan. 2010. Privacy Preserving Group Nearest Neighbour Queries in Location-Based Services Using Cryptographic Tech- niques. In GLOBECOM. 1&ndash;5. [17] Hidetoshi Kido, Yutaka Yanagisawa, and Tetsuji Satoh. 2005. An anonymous communication technique using dummies for location-based services. In ICPS. 88&ndash;97. [18] Feifei Li, Ke Yi, Yufei Tao, Bin Yao, Yang Li, Dong Xie, and Min Wang. 2016. Exact and approximate flexible aggregate similarity search. VLDB J. 25, 3 (2016), 317&ndash;338. [19] Yang Li, Feifei Li, Ke Yi, Bin Yao, and Min Wang. 2011. Flexible aggregate </span></p><p class="c109 c131"><span class="c19">similarity search. In SIGMOD. 1009&ndash;1020. [20] Hua Lu, Christian S. Jensen, and Man Lung Yiu. 2008. PAD: privacy-area aware, dummy-based location privacy in mobile services. In Seventh ACM International Workshop on Data Engineering for Wireless and Mobile Access. 16&ndash;23. [21] Mohamed F. Mokbel, Chi-Yin Chow, and Walid G. Aref. 2006. The New Casper: Query Processing for Location Services without Compromising Privacy. In PVLDB. 763&ndash;774. [22] Ben Niu, Qinghua Li, Xiaoyan Zhu, Guohong Cao, and Hui Li. 2014. Achieving k-anonymity in privacy-aware location-based services. In INFOCOM. 754&ndash;762. [23] Pascal Paillier. 1999. Public-Key Cryptosystems Based on Composite Degree </span></p><p class="c109 c129"><span class="c19">Residuosity Classes. In EUROCRYPT. 223&ndash;238. [24] Dimitris Papadias, Qiongmao Shen, Yufei Tao, and Kyriakos Mouratidis. 2004. </span></p><p class="c47"><span class="c19">Group Nearest Neighbor Queries. In ICDE. 301&ndash;312. [25] Dimitris Papadias, Yufei Tao, Kyriakos Mouratidis, and Chun Kit Hui. 2005. </span></p><p class="c29 c109"><span class="c19">Aggregate nearest neighbor queries in spatial databases. ACM Trans. Database Syst. 30, 2 (2005), 529&ndash;576. [26] Stavros Papadopoulos, Spiridon Bakiras, and Dimitris Papadias. 2010. Nearest </span></p><p class="c47"><span class="c19">Neighbor Search with Strong Location Privacy. PVLDB 3, 1 (2010), 619&ndash;629. [27] Russell Paulet, Md. Golam Kaosar, Xun Yi, and Elisa Bertino. 2014. Privacy- Preserving and Content-Protecting Location Based Queries. TKDE 26, 5 (2014), 1200&ndash;1210. [28] Humberto Luiz Razente, Maria Camila Nardini Barioni, Agma J. M. Traina, Christos Faloutsos, and Caetano Traina Jr. 2008. A novel optimization approach to efficiently process aggregate similarity queries in metric access methods. In CIKM. 193&ndash;202. [29] Jerome H. Saltzer and Michael D. Schroeder. 1975. The protection of informa- </span></p><p class="c155"><span class="c19">tion in computer systems. Proc. IEEE 63, 9 (1975), 1278&ndash;1308. [30] Pravin Shankar, Vinod Ganapathy, and Liviu Iftode. 2009. Privately querying </span></p><p class="c82"><span class="c19">location-based services with SybilQuery. In UbiComp. 31&ndash;40. [31] Xiaofen Wang, Yi Mu, and Rongmao Chen. 2016. One-Round Privacy- Preserving Meeting Location Determination for Smartphone Applications. IEEE Trans. Information Forensics and Security 11, 8 (2016), 1712&ndash;1721. [32] Wai Kit Wong, David Wai-Lok Cheung, Ben Kao, and Nikos Mamoulis. 2009. Secure kNN computation on encrypted databases. In SIGMOD. 139&ndash;152. [33] David J. Wu, Joe Zimmerman, J&eacute;r&eacute;my Planul, and John C. Mitchell. 2016. </span></p><p class="c109 c29 c168"><span class="c19">Privacy-Preserving Shortest Path Computation. In NDSS. [34] Yonghui Xiao and Li Xiong. 2015. Protecting Locations with Differential </span></p><p class="c109 c131"><span class="c19">Privacy under Temporal Correlations. In CCS. 1298&ndash;1309. [35] Andrew Chi-Chih Yao. 1982. Protocols for Secure Computations (Extended Abstract). In 23rd Annual Symposium on Foundations of Computer Science. 160&ndash;164. [36] Xun Yi, Russell Paulet, Elisa Bertino, and Vijay Varadharajan. 2016. Practical Approximate k Nearest Neighbor Queries with Location and Query Privacy. TKDE 28, 6 (2016), 1546&ndash;1559. [37] Man Lung Yiu, Christian S. Jensen, Xuegang Huang, and Hua Lu. 2008. SpaceTwist: Managing the Trade-Offs Among Location Privacy, Query Perfor- mance, and Query Accuracy in Mobile Services. In ICDE. 366&ndash;375. [38] Man Lung Yiu, Nikos Mamoulis, and Dimitris Papadias. 2005. Aggregate </span></p><p class="c109 c122"><span class="c19">Nearest Neighbor Queries in Road Networks. TKDE 17, 6 (2005), 820&ndash;833. </span></p><p class="c108"><span class="c88">288 </span></p></body></html>